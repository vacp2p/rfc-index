<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>00 (previous) - Logos LIP</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../../../favicon.png">
        <link rel="stylesheet" href="../../../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../../../css/general.css">
        <link rel="stylesheet" href="../../../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../../../highlight.css">
        <link rel="stylesheet" href="../../../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../../../../../theme/fonts/fonts.css">
        <link rel="stylesheet" href="../../../../../../theme/FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../../../custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../../../../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../../../../../../about.html">About</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/index.html"><strong aria-hidden="true">1.</strong> Messaging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/index.html"><strong aria-hidden="true">1.1.</strong> Standards - Core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/10/waku2.html"><strong aria-hidden="true">1.1.1.</strong> 10/WAKU2</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/11/relay.html"><strong aria-hidden="true">1.1.2.</strong> 11/WAKU2-RELAY</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/12/filter.html"><strong aria-hidden="true">1.1.3.</strong> 12/WAKU2-FILTER</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/12/previous-versions/00/filter.html"><strong aria-hidden="true">1.1.3.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/13/store.html"><strong aria-hidden="true">1.1.4.</strong> 13/WAKU2-STORE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/13/previous-versions/00/store.html" class="active"><strong aria-hidden="true">1.1.4.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/14/message.html"><strong aria-hidden="true">1.1.5.</strong> 14/WAKU2-MESSAGE</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/15/bridge.html"><strong aria-hidden="true">1.1.6.</strong> 15/WAKU-BRIDGE</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/17/rln-relay.html"><strong aria-hidden="true">1.1.7.</strong> 17/WAKU2-RLN-RELAY</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/19/lightpush.html"><strong aria-hidden="true">1.1.8.</strong> 19/WAKU2-LIGHTPUSH</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/31/enr.html"><strong aria-hidden="true">1.1.9.</strong> 31/WAKU2-ENR</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/33/discv5.html"><strong aria-hidden="true">1.1.10.</strong> 33/WAKU2-DISCV5</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/34/peer-exchange.html"><strong aria-hidden="true">1.1.11.</strong> 34/WAKU2-PEER-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/36/bindings-api.html"><strong aria-hidden="true">1.1.12.</strong> 36/WAKU2-BINDINGS-API</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/64/network.html"><strong aria-hidden="true">1.1.13.</strong> 64/WAKU2-NETWORK</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/core/66/metadata.html"><strong aria-hidden="true">1.1.14.</strong> 66/WAKU2-METADATA</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/application/index.html"><strong aria-hidden="true">1.2.</strong> Standards - Application</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/application/20/toy-eth-pm.html"><strong aria-hidden="true">1.2.1.</strong> 20/TOY-ETH-PM</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/application/26/payload.html"><strong aria-hidden="true">1.2.2.</strong> 26/WAKU2-PAYLOAD</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/application/53/x3dh.html"><strong aria-hidden="true">1.2.3.</strong> 53/WAKU2-X3DH</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/application/54/x3dh-sessions.html"><strong aria-hidden="true">1.2.4.</strong> 54/WAKU2-X3DH-SESSIONS</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/legacy/index.html"><strong aria-hidden="true">1.3.</strong> Standards - Legacy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/legacy/6/waku1.html"><strong aria-hidden="true">1.3.1.</strong> 6/WAKU1</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/legacy/7/data.html"><strong aria-hidden="true">1.3.2.</strong> 7/WAKU-DATA</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/legacy/8/mail.html"><strong aria-hidden="true">1.3.3.</strong> 8/WAKU-MAIL</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/standards/legacy/9/rpc.html"><strong aria-hidden="true">1.3.4.</strong> 9/WAKU-RPC</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/index.html"><strong aria-hidden="true">1.4.</strong> Informational</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/22/toy-chat.html"><strong aria-hidden="true">1.4.1.</strong> 22/TOY-CHAT</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/23/topics.html"><strong aria-hidden="true">1.4.2.</strong> 23/WAKU2-TOPICS</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/27/peers.html"><strong aria-hidden="true">1.4.3.</strong> 27/WAKU2-PEERS</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/29/config.html"><strong aria-hidden="true">1.4.4.</strong> 29/WAKU2-CONFIG</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/informational/30/adaptive-nodes.html"><strong aria-hidden="true">1.4.5.</strong> 30/ADAPTIVE-NODES</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../messaging/deprecated/index.html"><strong aria-hidden="true">1.5.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../messaging/deprecated/5/waku0.html"><strong aria-hidden="true">1.5.1.</strong> 5/WAKU0</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/deprecated/16/rpc.html"><strong aria-hidden="true">1.5.2.</strong> 16/WAKU2-RPC</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/deprecated/18/swap.html"><strong aria-hidden="true">1.5.3.</strong> 18/WAKU2-SWAP</a></li><li class="chapter-item expanded "><a href="../../../../../../messaging/deprecated/fault-tolerant-store.html"><strong aria-hidden="true">1.5.4.</strong> 21/WAKU2-FAULT-TOLERANT-STORE</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/index.html"><strong aria-hidden="true">2.</strong> Blockchain</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/index.html"><strong aria-hidden="true">2.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-anonymous-leaders-reward.html"><strong aria-hidden="true">2.1.1.</strong> BEDROCK-ANONYMOUS-LEADERS-REWARD</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-genesis-block.html"><strong aria-hidden="true">2.1.2.</strong> BEDROCK-GENESIS-BLOCK</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-service-declaration-protocol.html"><strong aria-hidden="true">2.1.3.</strong> BEDROCK-SERVICE-DECLARATION-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-service-reward-distribution.html"><strong aria-hidden="true">2.1.4.</strong> BEDROCK-SERVICE-REWARD-DISTRIBUTION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-v1.1-block-construction.html"><strong aria-hidden="true">2.1.5.</strong> BEDROCK-V1-1-BLOCK-CONSTRUCTION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/bedrock-v1.1-mantle-specification.html"><strong aria-hidden="true">2.1.6.</strong> BEDROCK-V1.1-MANTLE-SPECIFICATION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/cryptarchia-proof-of-leadership.html"><strong aria-hidden="true">2.1.7.</strong> CRYPTARCHIA-PROOF-OF-LEADERSHIP</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/cryptarchia-total-stake-inference.html"><strong aria-hidden="true">2.1.8.</strong> CRYPTARCHIA-TOTAL-STAKE-INFERENCE</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/cryptarchia-v1-bootstr-sync.html"><strong aria-hidden="true">2.1.9.</strong> CRYPTARCHIA-V1-BOOTSTRAPPING-SYNCHRONIZATION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-blend-protocol.html"><strong aria-hidden="true">2.1.10.</strong> NOMOS-BLEND-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-cryptarchia-v1-protocol.html"><strong aria-hidden="true">2.1.11.</strong> NOMOS-CRYPTARCHIA-V1-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomosda-network.html"><strong aria-hidden="true">2.1.12.</strong> NOMOS-DA-NETWORK</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-key-types-and-generation.html"><strong aria-hidden="true">2.1.13.</strong> NOMOS-KEY-TYPES-GENERATION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-message-encapsulation.html"><strong aria-hidden="true">2.1.14.</strong> NOMOS-MESSAGE-ENCAPSULATION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-message-formatting.html"><strong aria-hidden="true">2.1.15.</strong> NOMOS-MESSAGE-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/p2p-network.html"><strong aria-hidden="true">2.1.16.</strong> NOMOS-P2P-NETWORK</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-payload-formatting.html"><strong aria-hidden="true">2.1.17.</strong> NOMOS-PAYLOAD-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomos-proof-of-quota.html"><strong aria-hidden="true">2.1.18.</strong> NOMOS-PROOF-OF-QUOTA</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/nomosda-encoding.html"><strong aria-hidden="true">2.1.19.</strong> NOMOSDA-ENCODING</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/p2p-hardware-requirements.html"><strong aria-hidden="true">2.1.20.</strong> P2P-HARDWARE-REQUIREMENTS</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/p2p-nat-solution.html"><strong aria-hidden="true">2.1.21.</strong> P2P-NAT-SOLUTION</a></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/raw/p2p-network-bootstrapping.html"><strong aria-hidden="true">2.1.22.</strong> P2P-NETWORK-BOOTSTRAPPING</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../blockchain/deprecated/index.html"><strong aria-hidden="true">2.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../blockchain/deprecated/claro.html"><strong aria-hidden="true">2.2.1.</strong> CONSENSUS-CLARO</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../storage/index.html"><strong aria-hidden="true">3.</strong> Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../storage/raw/index.html"><strong aria-hidden="true">3.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../storage/raw/codex-block-exchange.html"><strong aria-hidden="true">3.1.1.</strong> CODEX-BLOCK-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/raw/community-history.html"><strong aria-hidden="true">3.1.2.</strong> CODEX-COMMUNITY-HISTORY</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/raw/dht.html"><strong aria-hidden="true">3.1.3.</strong> CODEX-DHT</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/raw/codex-merkle-tree.html"><strong aria-hidden="true">3.1.4.</strong> CODEX-MERKLE-TREE</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/raw/codex-store.html"><strong aria-hidden="true">3.1.5.</strong> CODEX-STORE</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../storage/deprecated/index.html"><strong aria-hidden="true">3.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../storage/deprecated/erasure-coding.html"><strong aria-hidden="true">3.2.1.</strong> CODEX-ERASUE-CODING</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/deprecated/codex-marketplace.html"><strong aria-hidden="true">3.2.2.</strong> CODEX-MARKETPLACE</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/deprecated/codex-prover.html"><strong aria-hidden="true">3.2.3.</strong> CODEX-PROVER</a></li><li class="chapter-item expanded "><a href="../../../../../../storage/deprecated/slot-buIlder.html"><strong aria-hidden="true">3.2.4.</strong> CODEX-SLOT-BUILDER</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/index.html"><strong aria-hidden="true">4.</strong> IFT-TS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/index.html"><strong aria-hidden="true">4.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/1/coss.html"><strong aria-hidden="true">4.1.1.</strong> 1/COSS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/2/mvds.html"><strong aria-hidden="true">4.1.2.</strong> 2/MVDS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/3/remote-log.html"><strong aria-hidden="true">4.1.3.</strong> 3/REMOTE-LOG</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/4/mvds-meta.html"><strong aria-hidden="true">4.1.4.</strong> 4/MVDS-META</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/25/libp2p-dns-discovery.html"><strong aria-hidden="true">4.1.5.</strong> 25/LIBP2P-DNS-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/32/rln-v1.html"><strong aria-hidden="true">4.1.6.</strong> 32/RLN-V1</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/decentralized-messaging-ethereum.html"><strong aria-hidden="true">4.1.7.</strong> ETH-DCGKA</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/eth-mls-offchain.html"><strong aria-hidden="true">4.1.8.</strong> ETH-MLS-OFFCHAIN</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/eth-mls-onchain.html"><strong aria-hidden="true">4.1.9.</strong> ETH-MLS-ONCHAIN</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/deleted/eth-secpm.html"><strong aria-hidden="true">4.1.10.</strong> ETH-SECPM</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/extended-kad-disco.html"><strong aria-hidden="true">4.1.11.</strong> EXTENDED-KADEMLIA-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/extensible-peer-records.html"><strong aria-hidden="true">4.1.12.</strong> EXTENSIBLE-PEER-RECORDS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/gossipsub-tor-push.html"><strong aria-hidden="true">4.1.13.</strong> GOSSIPSUB-TOR-PUSH</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/consensus-hashgraphlike.html"><strong aria-hidden="true">4.1.14.</strong> HASHGRAPHLIKE CONSENSUS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/logos-capability-discovery.html"><strong aria-hidden="true">4.1.15.</strong> LOGOS-CAPABILITY-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/mix.html"><strong aria-hidden="true">4.1.16.</strong> MIX</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/mix-spam-protection-rln.html"><strong aria-hidden="true">4.1.17.</strong> Mix Spam Protection RLN</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/multi-message_id-burn-rln.html"><strong aria-hidden="true">4.1.18.</strong> Multi-message_id Burn RLN</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/noise-x3dh-double-ratchet.html"><strong aria-hidden="true">4.1.19.</strong> NOISE-X3DH-DOUBLE-RATCHET</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/rln-interep-spec.html"><strong aria-hidden="true">4.1.20.</strong> RLN-INTEREP-SPEC</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/rln-stealth-commitments.html"><strong aria-hidden="true">4.1.21.</strong> RLN-STEALTH-COMMITMENTS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/rln-v2.html"><strong aria-hidden="true">4.1.22.</strong> RLN-V2</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/sds.html"><strong aria-hidden="true">4.1.23.</strong> SDS</a></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/raw/zerokit-api.html"><strong aria-hidden="true">4.1.24.</strong> Zerokit API</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../ift-ts/template.html"><strong aria-hidden="true">4.2.</strong> TEMPLATE</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../archived/index.html"><strong aria-hidden="true">5.</strong> Archived</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../archived/status/index.html"><strong aria-hidden="true">5.1.</strong> Status</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../archived/status/24/curation.html"><strong aria-hidden="true">5.1.1.</strong> 24/STATUS-CURATION</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/28/featuring.html"><strong aria-hidden="true">5.1.2.</strong> 28/STATUS-FEATURING</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/55/1to1-chat.html"><strong aria-hidden="true">5.1.3.</strong> 55/STATUS-1TO1-CHAT</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/56/communities.html"><strong aria-hidden="true">5.1.4.</strong> 56/STATUS-COMMUNITIES</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/61/community-history-service.html"><strong aria-hidden="true">5.1.5.</strong> 61/STATUS-Community-History-Service</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/62/payloads.html"><strong aria-hidden="true">5.1.6.</strong> 62/STATUS-PAYLOADS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/63/keycard-usage.html"><strong aria-hidden="true">5.1.7.</strong> 63/STATUS-Keycard-Usage</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/65/account-address.html"><strong aria-hidden="true">5.1.8.</strong> 65/STATUS-ACCOUNT-ADDRESS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/71/push-notification-server.html"><strong aria-hidden="true">5.1.9.</strong> 71/STATUS-PUSH-NOTIFICATION-SERVER</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/index.html"><strong aria-hidden="true">5.1.10.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/status-mvds.html"><strong aria-hidden="true">5.1.10.1.</strong> STATUS-MVDS-USAGE</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/status-app-protocols.html"><strong aria-hidden="true">5.1.10.2.</strong> STATUS-PROTOCOLS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/simple-scaling.html"><strong aria-hidden="true">5.1.10.3.</strong> STATUS-SIMPLE-SCALING</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/url-data.html"><strong aria-hidden="true">5.1.10.4.</strong> STATUS-URL-DATA</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/raw/url-scheme.html"><strong aria-hidden="true">5.1.10.5.</strong> STATUS-URL-SCHEME</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/index.html"><strong aria-hidden="true">5.1.11.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/3rd-party.html"><strong aria-hidden="true">5.1.11.1.</strong> 3RD-PARTY</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/account.html"><strong aria-hidden="true">5.1.11.2.</strong> ACCOUNT</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/client.html"><strong aria-hidden="true">5.1.11.3.</strong> CLIENT</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/dapp-browser-API-usage.html"><strong aria-hidden="true">5.1.11.4.</strong> Dapp browser API usage</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/eips.html"><strong aria-hidden="true">5.1.11.5.</strong> EIPS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/ethereum-usage.html"><strong aria-hidden="true">5.1.11.6.</strong> ETHEREUM-USAGE</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/group-chat.html"><strong aria-hidden="true">5.1.11.7.</strong> GROUP-CHAT</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/IPFS-gateway-for-sticker-Pack.html"><strong aria-hidden="true">5.1.11.8.</strong> IPFS-gateway-for-Sticker-Pack</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/keycard-usage-for-wallet-and-chat-keys.html"><strong aria-hidden="true">5.1.11.9.</strong> Keycard Usage for Wallet and Chat Keys</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/notifications.html"><strong aria-hidden="true">5.1.11.10.</strong> NOTIFICATIONS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/payloads.html"><strong aria-hidden="true">5.1.11.11.</strong> PAYLOADS</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/push-notification-server.html"><strong aria-hidden="true">5.1.11.12.</strong> PUSH-NOTIFICATION-SERVER</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/secure-transport.html"><strong aria-hidden="true">5.1.11.13.</strong> SECURE-TRANSPORT</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/waku-mailserver.html"><strong aria-hidden="true">5.1.11.14.</strong> WAKU-MAILSERVER</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/waku-usage.html"><strong aria-hidden="true">5.1.11.15.</strong> WAKU-USAGE</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/whisper-mailserver.html"><strong aria-hidden="true">5.1.11.16.</strong> WHISPER-MAILSERVER</a></li><li class="chapter-item expanded "><a href="../../../../../../archived/status/deprecated/whisper-usage.html"><strong aria-hidden="true">5.1.11.17.</strong> WHISPER-USAGE</a></li></ol></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Logos LIP</h1>

                    <div class="right-buttons">
                        <a href="../../../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/vacp2p/rfc-index" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="13waku2-store"><a class="header" href="#13waku2-store">13/WAKU2-STORE</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody>
<tr><td>Name</td><td>Waku v2 Store</td></tr>
<tr><td>Slug</td><td>13</td></tr>
<tr><td>Status</td><td>draft</td></tr>
<tr><td>Editor</td><td>Simon-Pierre Vivier <a href="mailto:simvivier@status.im">simvivier@status.im</a></td></tr>
<tr><td>Contributors</td><td>Dean Eigenmann <a href="mailto:dean@status.im">dean@status.im</a>, Oskar Thorén <a href="mailto:oskarth@titanproxy.com">oskarth@titanproxy.com</a>, Aaryamann Challani <a href="mailto:p1ge0nh8er@proton.me">p1ge0nh8er@proton.me</a>, Sanaz Taheri <a href="mailto:sanaz@status.im">sanaz@status.im</a>, Hanno Cornelius <a href="mailto:hanno@status.im">hanno@status.im</a></td></tr>
</tbody></table>
</div><!-- timeline:start -->
<h2 id="timeline"><a class="header" href="#timeline">Timeline</a></h2>
<ul>
<li><strong>2026-01-16</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/f01d5b9d9f2ef977b8c089d616991b24f2ee4efe/docs/messaging/standards/core/13/previous-versions/00/store.md"><code>f01d5b9</code></a> — chore: fix links (#260)</li>
<li><strong>2026-01-16</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/89f2ea89fc1d69ab238b63c7e6fb9e4203fd8529/docs/messaging/standards/core/13/previous-versions/00/store.md"><code>89f2ea8</code></a> — Chore/mdbook updates (#258)</li>
<li><strong>2025-12-22</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/0f1855edcf68ef982c4ce478b67d660809aa9830/docs/waku/standards/core/13/previous-versions/00/store.md"><code>0f1855e</code></a> — Chore/fix headers (#239)</li>
<li><strong>2025-12-22</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/b1a578393edf8487ccc97a5f25b25af9bf41efb3/docs/waku/standards/core/13/previous-versions/00/store.md"><code>b1a5783</code></a> — Chore/mdbook updates (#237)</li>
<li><strong>2025-12-18</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/d03e699084774ebecef9c6d4662498907c5e2080/docs/waku/standards/core/13/previous-versions/00/store.md"><code>d03e699</code></a> — ci: add mdBook configuration (#233)</li>
<li><strong>2025-02-03</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/a60a2c45de49966c3550e0f5efe2fa4b081dd40f/waku/standards/core/13/previous-versions/00/store.md"><code>a60a2c4</code></a> — 13/WAKU-STORE: Update (#124)</li>
<li><strong>2024-09-13</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/3ab314d87d4525ff1296bf3d9ec634d570777b91/waku/standards/core/13/store.md"><code>3ab314d</code></a> — Fix Files for Linting (#94)</li>
<li><strong>2024-08-05</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/eb25cd06d679e94409072a96841de16a6b3910d5/waku/standards/core/13/store.md"><code>eb25cd0</code></a> — chore: replace email addresses (#86)</li>
<li><strong>2024-03-21</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/2eaa7949c4abe7d14e2b9560e8c045bf2e937c9a/waku/standards/core/13/store.md"><code>2eaa794</code></a> — Broken Links + Change Editors (#26)</li>
<li><strong>2024-02-01</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/755be9440d31a71ffdc3c250baa802f0220f29e5/waku/standards/core/13/store.md"><code>755be94</code></a> — Update and rename STORE.md to store.md</li>
<li><strong>2024-01-27</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/3baed074afeae25c69e15af1b6534d0bf89034c2/waku/standards/core/13/STORE.md"><code>3baed07</code></a> — Rename README.md to STORE.md</li>
<li><strong>2024-01-27</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/eef961bfe3b1cf6aab66df5450555afd1d3543cb/waku/standards/core/13/README.md"><code>eef961b</code></a> — remove rfs folder</li>
<li><strong>2024-01-25</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/51e28795c2b64c87c741ec7b3a6669e0d020e1e5/waku/rfcs/standards/core/13/README.md"><code>51e2879</code></a> — Create README.md</li>
</ul>
<!-- timeline:end -->
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>This specification explains the <code>13/WAKU2-STORE</code> protocol
which enables querying of messages received through the relay protocol and
stored by other nodes.
It also supports pagination for more efficient querying of historical messages.</p>
<p><strong>Protocol identifier</strong>*: <code>/vac/waku/store/2.0.0-beta4</code></p>
<h2 id="terminology"><a class="header" href="#terminology">Terminology</a></h2>
<p>The term PII, Personally Identifiable Information,
refers to any piece of data that can be used to uniquely identify a user.
For example, the signature verification key, and
the hash of one's static IP address are unique for each user and hence count as PII.</p>
<h2 id="design-requirements"><a class="header" href="#design-requirements">Design Requirements</a></h2>
<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”,
“SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and
“OPTIONAL” in this document are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC2119</a>.</p>
<p>Nodes willing to provide the storage service using <code>13/WAKU2-STORE</code> protocol,
SHOULD provide a complete and full view of message history.
As such, they are required to be <em>highly available</em> and
specifically have a <em>high uptime</em> to consistently receive and store network messages.
The high uptime requirement makes sure that no message is missed out
hence a complete and intact view of the message history
is delivered to the querying nodes.
Nevertheless, in case storage provider nodes cannot afford high availability,
the querying nodes may retrieve the historical messages from multiple sources
to achieve a full and intact view of the past.</p>
<p>The concept of <code>ephemeral</code> messages introduced in
<a href="../../../14/message.html"><code>14/WAKU2-MESSAGE</code></a> affects <code>13/WAKU2-STORE</code> as well.
Nodes running <code>13/WAKU2-STORE</code> SHOULD support <code>ephemeral</code> messages as specified in
<a href="../../../14/message.html">14/WAKU2-MESSAGE</a>.
Nodes running <code>13/WAKU2-STORE</code> SHOULD NOT store messages
with the <code>ephemeral</code> flag set to <code>true</code>.</p>
<h2 id="adversarial-model"><a class="header" href="#adversarial-model">Adversarial Model</a></h2>
<p>Any peer running the <code>13/WAKU2-STORE</code> protocol, i.e.
both the querying node and the queried node, are considered as an adversary.
Furthermore,
we currently consider the adversary as a passive entity
that attempts to collect information from other peers to conduct an attack but
it does so without violating protocol definitions and instructions.
As we evolve the protocol,
further adversarial models will be considered.
For example, under the passive adversarial model,
no malicious node hides or
lies about the history of messages
as it is against the description of the <code>13/WAKU2-STORE</code> protocol.</p>
<p>The following are not considered as part of the adversarial model:</p>
<ul>
<li>An adversary with a global view of all the peers and their connections.</li>
<li>An adversary that can eavesdrop on communication links
between arbitrary pairs of peers (unless the adversary is one end of the communication).
In specific, the communication channels are assumed to be secure.</li>
</ul>
<h2 id="wire-specification"><a class="header" href="#wire-specification">Wire Specification</a></h2>
<p>Peers communicate with each other using a request / response API.
The messages sent are Protobuf RPC messages which are implemented using
<a href="https://developers.google.com/protocol-buffers/">protocol buffers v3</a>.
The following are the specifications of the Protobuf messages.</p>
<h3 id="payloads"><a class="header" href="#payloads">Payloads</a></h3>
<pre><code class="language-protobuf">syntax = "proto3";

message Index {
  bytes digest = 1;
  sint64 receiverTime = 2;
  sint64 senderTime = 3;
  string pubsubTopic = 4;
}

message PagingInfo {
  uint64 pageSize = 1;
  Index cursor = 2;
  enum Direction {
    BACKWARD = 0;
    FORWARD = 1;
  }
  Direction direction = 3;
}

message ContentFilter {
  string contentTopic = 1;
}

message HistoryQuery {
  // the first field is reserved for future use
  string pubsubtopic = 2;
  repeated ContentFilter contentFilters = 3;
  PagingInfo pagingInfo = 4;
}

message HistoryResponse {
  // the first field is reserved for future use
  repeated WakuMessage messages = 2;
  PagingInfo pagingInfo = 3;
  enum Error {
    NONE = 0;
    INVALID_CURSOR = 1;
  }
  Error error = 4;
}

message HistoryRPC {
  string request_id = 1;
  HistoryQuery query = 2;
  HistoryResponse response = 3;
}
</code></pre>
<h4 id="index"><a class="header" href="#index">Index</a></h4>
<p>To perform pagination,
each <code>WakuMessage</code> stored at a node running the <code>13/WAKU2-STORE</code> protocol
is associated with a unique <code>Index</code> that encapsulates the following parts.</p>
<ul>
<li><code>digest</code>:  a sequence of bytes representing the SHA256 hash of a <code>WakuMessage</code>.
The hash is computed over the concatenation of <code>contentTopic</code>
and <code>payload</code> fields of a <code>WakuMessage</code> (see <a href="../../../14/message.html">14/WAKU2-MESSAGE</a>).</li>
<li><code>receiverTime</code>: the UNIX time in nanoseconds
at which the <code>WakuMessage</code> is received by the receiving node.</li>
<li><code>senderTime</code>: the UNIX time in nanoseconds
at which the <code>WakuMessage</code> is generated by its sender.</li>
<li><code>pubsubTopic</code>: the pubsub topic on which the <code>WakuMessage</code> is received.</li>
</ul>
<h4 id="paginginfo"><a class="header" href="#paginginfo">PagingInfo</a></h4>
<p><code>PagingInfo</code> holds the information required for pagination.
It consists of the following components.</p>
<ul>
<li><code>pageSize</code>: A positive integer indicating the number of queried <code>WakuMessage</code>s
in a <code>HistoryQuery</code>
(or retrieved  <code>WakuMessage</code>s in a <code>HistoryResponse</code>).</li>
<li><code>cursor</code>: holds the <code>Index</code> of a <code>WakuMessage</code>.</li>
<li><code>direction</code>: indicates the direction of paging
which can be either <code>FORWARD</code> or <code>BACKWARD</code>.</li>
</ul>
<h4 id="contentfilter"><a class="header" href="#contentfilter">ContentFilter</a></h4>
<p><code>ContentFilter</code> carries the information required for filtering historical messages.</p>
<ul>
<li><code>contentTopic</code> represents the content topic of the queried historical <code>WakuMessage</code>.
This field maps to the <code>contentTopic</code> field of the <a href="../../../14/message.html">14/WAKU2-MESSAGE</a>.</li>
</ul>
<h4 id="historyquery"><a class="header" href="#historyquery">HistoryQuery</a></h4>
<p>RPC call to query historical messages.</p>
<ul>
<li>The <code>pubsubTopic</code> field MUST indicate the pubsub topic
of the historical messages to be retrieved.
This field denotes the pubsub topic on which <code>WakuMessage</code>s are published.
This field maps to <code>topicIDs</code> field of <code>Message</code> in <a href="../../../11/relay.html"><code>11/WAKU2-RELAY</code></a>.
Leaving this field empty means no filter on the pubsub topic
of message history is requested.
This field SHOULD be left empty in order to retrieve the historical <code>WakuMessage</code>
regardless of the pubsub topics on which they are published.</li>
<li>The <code>contentFilters</code> field MUST indicate the list of content filters
based on which the historical messages are to be retrieved.
Leaving this field empty means no filter on the content topic
of message history is required.
This field SHOULD be left empty in order
to retrieve historical <code>WakuMessage</code> regardless of their content topics.</li>
<li><code>PagingInfo</code> holds the information required for pagination.<br />
Its <code>pageSize</code> field indicates the number of  <code>WakuMessage</code>s
to be included in the corresponding <code>HistoryResponse</code>.
It is RECOMMENDED that the queried node defines a maximum page size internally.
If the querying node leaves the <code>pageSize</code> unspecified,
or if the <code>pageSize</code> exceeds the maximum page size,
the queried node SHOULD auto-paginate the <code>HistoryResponse</code>
to no more than the configured maximum page size.
This allows mitigation of long response time for <code>HistoryQuery</code>.
In the forward pagination request,
the <code>messages</code> field of the <code>HistoryResponse</code> SHALL contain, at maximum,
the <code>pageSize</code> amount of <code>WakuMessage</code> whose <code>Index</code>
values are larger than the given <code>cursor</code>
(and vise versa for the backward pagination).
Note that the <code>cursor</code> of a <code>HistoryQuery</code> MAY be empty
(e.g., for the initial query), as such, and
depending on whether the  <code>direction</code> is <code>BACKWARD</code> or
<code>FORWARD</code>  the last or the first <code>pageSize</code> <code>WakuMessage</code> SHALL be returned,
respectively.</li>
</ul>
<h4 id="sorting-messages"><a class="header" href="#sorting-messages">Sorting Messages</a></h4>
<p>The queried node MUST sort the <code>WakuMessage</code> based on their <code>Index</code>,
where the <code>senderTime</code> constitutes the most significant part and
the <code>digest</code> comes next, and
then perform pagination on the sorted result.
As such, the retrieved page contains an ordered list of <code>WakuMessage</code>
from the oldest messages to the most recent one.
Alternatively, the <code>receiverTime</code> (instead of <code>senderTime</code>)
MAY be used to sort messages during the paging process.
However, it is RECOMMENDED the use of the <code>senderTime</code>
for sorting as it is invariant and
consistent across all the nodes.
This has the benefit of <code>cursor</code> reusability i.e.,
a <code>cursor</code> obtained from one node can be consistently used
to query from another node.
However, this <code>cursor</code> reusability does not hold when the <code>receiverTime</code> is utilized
as the receiver time is affected by the network delay and
nodes' clock asynchrony.</p>
<h4 id="historyresponse"><a class="header" href="#historyresponse">HistoryResponse</a></h4>
<p>RPC call to respond to a HistoryQuery call.</p>
<ul>
<li>The <code>messages</code> field MUST contain the messages found,
these are <a href="../../../14/message.html">14/WAKU2-MESSAGE</a> types.</li>
<li><code>PagingInfo</code>  holds the paging information based
on which the querying node can resume its further history queries.
The <code>pageSize</code> indicates the number of returned Waku messages
(i.e., the number of messages included in the <code>messages</code> field of <code>HistoryResponse</code>).
The <code>direction</code> is the same direction as in the corresponding <code>HistoryQuery</code>.
In the forward pagination, the <code>cursor</code> holds the <code>Index</code> of the last message
in the <code>HistoryResponse</code> <code>messages</code> (and the first message in the backward paging).
Regardless of the paging direction,
the retrieved <code>messages</code> are always sorted in ascending order
based on their timestamp as explained in the <a href="#sorting-messages">sorting messages</a>section,
that is, from the oldest to the most recent.
The requester SHALL embed the returned <code>cursor</code> inside its next <code>HistoryQuery</code>
to retrieve the next page of the <a href="../../../14/message.html">14/WAKU2-MESSAGE</a>.<br />
The <code>cursor</code> obtained from one node SHOULD NOT be used in a request to another node
because the result may be different.</li>
<li>The <code>error</code> field contains information about any error that has occurred
while processing the corresponding <code>HistoryQuery</code>.
<code>NONE</code> stands for no error.
This is also the default value.
<code>INVALID_CURSOR</code> means that the <code>cursor</code> field of <code>HistoryQuery</code>
does not match with the <code>Index</code> of any of the <code>WakuMessage</code>
persisted by the queried node.</li>
</ul>
<h2 id="security-consideration"><a class="header" href="#security-consideration">Security Consideration</a></h2>
<p>The main security consideration to take into account
while using this protocol is that a querying node
have to reveal their content filters of interest to the queried node,
hence potentially compromising their privacy.</p>
<h2 id="future-work"><a class="header" href="#future-work">Future Work</a></h2>
<ul>
<li><strong>Anonymous query</strong>: This feature guarantees that nodes
can anonymously query historical messages from other nodes i.e.,
without disclosing the exact topics of <a href="../../../14/message.html">14/WAKU2-MESSAGE</a>
they are interested in.<br />
As such, no adversary in the <code>13/WAKU2-STORE</code> protocol
would be able to learn which peer is interested in which content filters i.e.,
content topics of <a href="../../../14/message.html">14/WAKU2-MESSAGE</a>.
The current version of the <code>13/WAKU2-STORE</code> protocol does not provide anonymity
for historical queries,
as the querying node needs to directly connect to another node
in the <code>13/WAKU2-STORE</code> protocol and
explicitly disclose the content filters of its interest
to retrieve the corresponding messages.
However, one can consider preserving anonymity through one of the following ways:
<ul>
<li>By hiding the source of the request i.e., anonymous communication.
That is the querying node shall hide all its PII in its history request
e.g., its IP address.
This can happen by the utilization of a proxy server or by using Tor.
Note that the current structure of historical requests
does not embody any piece of PII, otherwise,
such data fields must be treated carefully to achieve query anonymity.</li>
</ul>
<!-- TODO: if nodes have to disclose their PeerIDs
(e.g., for authentication purposes) when connecting to other nodes
in the store protocol,
then Tor does not preserve anonymity since it only helps in hiding the IP.
So, the PeerId usage in switches must be investigated further.
Depending on how PeerId is used, one may be able to link between a querying node
and its queried topics despite hiding the IP address-->
<ul>
<li>By deploying secure 2-party computations in which the querying node
obtains the historical messages of a certain topic,
the queried node learns nothing about the query.
Examples of such 2PC protocols are secure one-way Private Set Intersections (PSI).</li>
</ul>
<!-- TODO: add a reference for PSIs? -->
<!-- TODO: more techniques to be included -->
</li>
</ul>
<!-- TODO: Censorship resistant:
this is about a node that hides the historical messages from other nodes.
This attack is not included in the specs
since it does not fit the passive adversarial model
(the attacker needs to deviate from the store protocol).-->
<ul>
<li><strong>Robust and verifiable timestamps</strong>:
Messages timestamp is a way to show that the message existed
prior to some point in time.
However, the lack of timestamp verifiability can create room for a range of attacks,
including injecting messages with invalid timestamps pointing to the far future.
To better understand the attack,
consider a store node whose current clock shows <code>2021-01-01 00:00:30</code>
(and assume all the other nodes have a synchronized clocks +-20seconds).
The store node already has a list of messages,
<code>(m1,2021-01-01 00:00:00), (m2,2021-01-01 00:00:01), ..., (m10:2021-01-01 00:00:20)</code>,
that are sorted based on their timestamp.<br />
An attacker sends a message with an arbitrary large timestamp e.g.,
10 hours ahead of the correct clock <code>(m',2021-01-01 10:00:30)</code>.
The store node places <code>m'</code> at the end of the list,</li>
</ul>
<pre><code class="language-text">(m1,2021-01-01 00:00:00), (m2,2021-01-01 00:00:01), ..., (m10:2021-01-01 00:00:20),(m',2021-01-01 10:00:30).
</code></pre>
<p>Now another message arrives with a valid timestamp e.g.,
<code>(m11, 2021-01-01 00:00:45)</code>.
However, since its timestamp precedes the malicious message <code>m'</code>,
it gets placed before <code>m'</code> in the list i.e.,</p>
<pre><code class="language-text">(m1,2021-01-01 00:00:00), (m2,2021-01-01 00:00:01), ..., (m10:2021-01-01 00:00:20), (m11, 2021-01-01 00:00:45), (m',2021-01-01 10:00:30).
</code></pre>
<p>In fact, for the next 10 hours,
<code>m'</code> will always be considered as the most recent message and
served as the last message to the querying nodes irrespective
of how many other messages arrive afterward.</p>
<p>A robust and verifiable timestamp allows the receiver of a message
to verify that a message has been generated prior to the claimed timestamp.
One solution is the use of <a href="https://opentimestamps.org/">open timestamps</a> e.g.,
block height in Blockchain-based timestamps.
That is, messages contain the most recent block height
perceived by their senders at the time of message generation.
This proves accuracy within a range of minutes (e.g., in Bitcoin blockchain) or
seconds (e.g., in Ethereum 2.0) from the time of origination.</p>
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p>Copyright and related rights waived via
<a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<ol>
<li><a href="../../../14/message.html">14/WAKU2-MESSAGE</a></li>
<li><a href="https://developers.google.com/protocol-buffers/">protocol buffers v3</a></li>
<li><a href="../../../11/relay.html">11/WAKU2-RELAY</a></li>
<li><a href="https://opentimestamps.org/">Open timestamps</a></li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../../../messaging/standards/core/13/store.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../../../../messaging/standards/core/14/message.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../../../messaging/standards/core/13/store.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../../../../messaging/standards/core/14/message.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../../../elasticlunr.min.js"></script>
        <script src="../../../../../../mark.min.js"></script>
        <script src="../../../../../../searcher.js"></script>

        <script src="../../../../../../clipboard.min.js"></script>
        <script src="../../../../../../highlight.js"></script>
        <script src="../../../../../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../../../../../scripts/rfc-index.js"></script>


    </div>
    </body>
</html>
