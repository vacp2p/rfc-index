<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>CRYPTARCHIA-PROOF-OF-LEADERSHIP - Logos LIP</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/fonts/fonts.css">
        <link rel="stylesheet" href="../../theme/FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../../about.html">About</a></li><li class="chapter-item expanded "><a href="../../messaging/index.html"><strong aria-hidden="true">1.</strong> Messaging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/index.html"><strong aria-hidden="true">1.1.</strong> Standards - Core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/10/waku2.html"><strong aria-hidden="true">1.1.1.</strong> 10/WAKU2</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/11/relay.html"><strong aria-hidden="true">1.1.2.</strong> 11/WAKU2-RELAY</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/12/filter.html"><strong aria-hidden="true">1.1.3.</strong> 12/WAKU2-FILTER</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/12/previous-versions/00/filter.html"><strong aria-hidden="true">1.1.3.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/13/store.html"><strong aria-hidden="true">1.1.4.</strong> 13/WAKU2-STORE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/13/previous-versions/00/store.html"><strong aria-hidden="true">1.1.4.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/14/message.html"><strong aria-hidden="true">1.1.5.</strong> 14/WAKU2-MESSAGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/15/bridge.html"><strong aria-hidden="true">1.1.6.</strong> 15/WAKU-BRIDGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/17/rln-relay.html"><strong aria-hidden="true">1.1.7.</strong> 17/WAKU2-RLN-RELAY</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/19/lightpush.html"><strong aria-hidden="true">1.1.8.</strong> 19/WAKU2-LIGHTPUSH</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/31/enr.html"><strong aria-hidden="true">1.1.9.</strong> 31/WAKU2-ENR</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/33/discv5.html"><strong aria-hidden="true">1.1.10.</strong> 33/WAKU2-DISCV5</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/34/peer-exchange.html"><strong aria-hidden="true">1.1.11.</strong> 34/WAKU2-PEER-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/36/bindings-api.html"><strong aria-hidden="true">1.1.12.</strong> 36/WAKU2-BINDINGS-API</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/64/network.html"><strong aria-hidden="true">1.1.13.</strong> 64/WAKU2-NETWORK</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/66/metadata.html"><strong aria-hidden="true">1.1.14.</strong> 66/WAKU2-METADATA</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/index.html"><strong aria-hidden="true">1.2.</strong> Standards - Application</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/application/20/toy-eth-pm.html"><strong aria-hidden="true">1.2.1.</strong> 20/TOY-ETH-PM</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/26/payload.html"><strong aria-hidden="true">1.2.2.</strong> 26/WAKU2-PAYLOAD</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/53/x3dh.html"><strong aria-hidden="true">1.2.3.</strong> 53/WAKU2-X3DH</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/54/x3dh-sessions.html"><strong aria-hidden="true">1.2.4.</strong> 54/WAKU2-X3DH-SESSIONS</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/index.html"><strong aria-hidden="true">1.3.</strong> Standards - Legacy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/6/waku1.html"><strong aria-hidden="true">1.3.1.</strong> 6/WAKU1</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/7/data.html"><strong aria-hidden="true">1.3.2.</strong> 7/WAKU-DATA</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/8/mail.html"><strong aria-hidden="true">1.3.3.</strong> 8/WAKU-MAIL</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/9/rpc.html"><strong aria-hidden="true">1.3.4.</strong> 9/WAKU-RPC</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/informational/index.html"><strong aria-hidden="true">1.4.</strong> Informational</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/informational/22/toy-chat.html"><strong aria-hidden="true">1.4.1.</strong> 22/TOY-CHAT</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/23/topics.html"><strong aria-hidden="true">1.4.2.</strong> 23/WAKU2-TOPICS</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/27/peers.html"><strong aria-hidden="true">1.4.3.</strong> 27/WAKU2-PEERS</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/29/config.html"><strong aria-hidden="true">1.4.4.</strong> 29/WAKU2-CONFIG</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/30/adaptive-nodes.html"><strong aria-hidden="true">1.4.5.</strong> 30/ADAPTIVE-NODES</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/index.html"><strong aria-hidden="true">1.5.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/deprecated/5/waku0.html"><strong aria-hidden="true">1.5.1.</strong> 5/WAKU0</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/16/rpc.html"><strong aria-hidden="true">1.5.2.</strong> 16/WAKU2-RPC</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/18/swap.html"><strong aria-hidden="true">1.5.3.</strong> 18/WAKU2-SWAP</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/fault-tolerant-store.html"><strong aria-hidden="true">1.5.4.</strong> 21/WAKU2-FAULT-TOLERANT-STORE</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../blockchain/index.html"><strong aria-hidden="true">2.</strong> Blockchain</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/raw/index.html"><strong aria-hidden="true">2.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-anonymous-leaders-reward.html"><strong aria-hidden="true">2.1.1.</strong> BEDROCK-ANONYMOUS-LEADERS-REWARD</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-architecture-overview.html"><strong aria-hidden="true">2.1.2.</strong> BEDROCK-ARCHITECTURE-OVERVIEW</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-genesis-block.html"><strong aria-hidden="true">2.1.3.</strong> BEDROCK-GENESIS-BLOCK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-service-declaration-protocol.html"><strong aria-hidden="true">2.1.4.</strong> BEDROCK-SERVICE-DECLARATION-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-service-reward-distribution.html"><strong aria-hidden="true">2.1.5.</strong> BEDROCK-SERVICE-REWARD-DISTRIBUTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-v1.1-block-construction.html"><strong aria-hidden="true">2.1.6.</strong> BEDROCK-V1-1-BLOCK-CONSTRUCTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-v1.1-mantle-specification.html"><strong aria-hidden="true">2.1.7.</strong> BEDROCK-V1.1-MANTLE-SPECIFICATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/fork-choice.html"><strong aria-hidden="true">2.1.8.</strong> CRYPTARCHIA-FORK-CHOICE</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-proof-of-leadership.html" class="active"><strong aria-hidden="true">2.1.9.</strong> CRYPTARCHIA-PROOF-OF-LEADERSHIP</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-total-stake-inference.html"><strong aria-hidden="true">2.1.10.</strong> CRYPTARCHIA-TOTAL-STAKE-INFERENCE</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-v1-bootstr-sync.html"><strong aria-hidden="true">2.1.11.</strong> CRYPTARCHIA-V1-BOOTSTRAPPING-SYNCHRONIZATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-blend-protocol.html"><strong aria-hidden="true">2.1.12.</strong> NOMOS-BLEND-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-cryptarchia-v1-protocol.html"><strong aria-hidden="true">2.1.13.</strong> NOMOS-CRYPTARCHIA-V1-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomosda-network.html"><strong aria-hidden="true">2.1.14.</strong> NOMOS-DA-NETWORK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-key-types-and-generation.html"><strong aria-hidden="true">2.1.15.</strong> NOMOS-KEY-TYPES-GENERATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-message-encapsulation.html"><strong aria-hidden="true">2.1.16.</strong> NOMOS-MESSAGE-ENCAPSULATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-message-formatting.html"><strong aria-hidden="true">2.1.17.</strong> NOMOS-MESSAGE-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-network.html"><strong aria-hidden="true">2.1.18.</strong> NOMOS-P2P-NETWORK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-payload-formatting.html"><strong aria-hidden="true">2.1.19.</strong> NOMOS-PAYLOAD-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-proof-of-quota.html"><strong aria-hidden="true">2.1.20.</strong> NOMOS-PROOF-OF-QUOTA</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/da-cryptographic-protocol.html"><strong aria-hidden="true">2.1.21.</strong> NOMOSDA-CRYPTOGRAPHIC-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/da-rewarding.html"><strong aria-hidden="true">2.1.22.</strong> NOMOSDA-REWARDING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-hardware-requirements.html"><strong aria-hidden="true">2.1.23.</strong> P2P-HARDWARE-REQUIREMENTS</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-nat-solution.html"><strong aria-hidden="true">2.1.24.</strong> P2P-NAT-SOLUTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-network-bootstrapping.html"><strong aria-hidden="true">2.1.25.</strong> P2P-NETWORK-BOOTSTRAPPING</a></li></ol></li><li class="chapter-item expanded "><a href="../../blockchain/deprecated/index.html"><strong aria-hidden="true">2.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/deprecated/claro.html"><strong aria-hidden="true">2.2.1.</strong> CONSENSUS-CLARO</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../storage/index.html"><strong aria-hidden="true">3.</strong> Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/raw/index.html"><strong aria-hidden="true">3.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/raw/codex-block-exchange.html"><strong aria-hidden="true">3.1.1.</strong> CODEX-BLOCK-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../storage/raw/community-history.html"><strong aria-hidden="true">3.1.2.</strong> CODEX-COMMUNITY-HISTORY</a></li><li class="chapter-item expanded "><a href="../../storage/raw/dht.html"><strong aria-hidden="true">3.1.3.</strong> CODEX-DHT</a></li><li class="chapter-item expanded "><a href="../../storage/raw/manifest.html"><strong aria-hidden="true">3.1.4.</strong> CODEX-MANIFEST</a></li><li class="chapter-item expanded "><a href="../../storage/raw/codex-merkle-tree.html"><strong aria-hidden="true">3.1.5.</strong> CODEX-MERKLE-TREE</a></li><li class="chapter-item expanded "><a href="../../storage/raw/codex-store.html"><strong aria-hidden="true">3.1.6.</strong> CODEX-STORE</a></li></ol></li><li class="chapter-item expanded "><a href="../../storage/deprecated/index.html"><strong aria-hidden="true">3.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/deprecated/erasure-coding.html"><strong aria-hidden="true">3.2.1.</strong> CODEX-ERASUE-CODING</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/codex-marketplace.html"><strong aria-hidden="true">3.2.2.</strong> CODEX-MARKETPLACE</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/codex-prover.html"><strong aria-hidden="true">3.2.3.</strong> CODEX-PROVER</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/slot-buIlder.html"><strong aria-hidden="true">3.2.4.</strong> CODEX-SLOT-BUILDER</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../ift-ts/index.html"><strong aria-hidden="true">4.</strong> IFT-TS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ift-ts/raw/index.html"><strong aria-hidden="true">4.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ift-ts/raw/1/coss.html"><strong aria-hidden="true">4.1.1.</strong> 1/COSS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/2/mvds.html"><strong aria-hidden="true">4.1.2.</strong> 2/MVDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/3/remote-log.html"><strong aria-hidden="true">4.1.3.</strong> 3/REMOTE-LOG</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/4/mvds-meta.html"><strong aria-hidden="true">4.1.4.</strong> 4/MVDS-META</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/25/libp2p-dns-discovery.html"><strong aria-hidden="true">4.1.5.</strong> 25/LIBP2P-DNS-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/32/rln-v1.html"><strong aria-hidden="true">4.1.6.</strong> 32/RLN-V1</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/decentralized-messaging-ethereum.html"><strong aria-hidden="true">4.1.7.</strong> ETH-DCGKA</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/eth-mls-offchain.html"><strong aria-hidden="true">4.1.8.</strong> ETH-MLS-OFFCHAIN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/eth-mls-onchain.html"><strong aria-hidden="true">4.1.9.</strong> ETH-MLS-ONCHAIN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/deleted/eth-secpm.html"><strong aria-hidden="true">4.1.10.</strong> ETH-SECPM</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/extended-kad-disco.html"><strong aria-hidden="true">4.1.11.</strong> EXTENDED-KADEMLIA-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/extensible-peer-records.html"><strong aria-hidden="true">4.1.12.</strong> EXTENSIBLE-PEER-RECORDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/gossipsub-tor-push.html"><strong aria-hidden="true">4.1.13.</strong> GOSSIPSUB-TOR-PUSH</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/consensus-hashgraphlike.html"><strong aria-hidden="true">4.1.14.</strong> HASHGRAPHLIKE CONSENSUS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/logos-capability-discovery.html"><strong aria-hidden="true">4.1.15.</strong> LOGOS-CAPABILITY-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/mix.html"><strong aria-hidden="true">4.1.16.</strong> MIX</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/multi-message_id-burn-rln.html"><strong aria-hidden="true">4.1.17.</strong> Multi-message_id Burn RLN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/noise-x3dh-double-ratchet.html"><strong aria-hidden="true">4.1.18.</strong> NOISE-X3DH-DOUBLE-RATCHET</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/mix-spam-protection-rln.html"><strong aria-hidden="true">4.1.19.</strong> RLN DoS Protection for Mixnet</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-interep-spec.html"><strong aria-hidden="true">4.1.20.</strong> RLN-INTEREP-SPEC</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-stealth-commitments.html"><strong aria-hidden="true">4.1.21.</strong> RLN-STEALTH-COMMITMENTS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-v2.html"><strong aria-hidden="true">4.1.22.</strong> RLN-V2</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/sds.html"><strong aria-hidden="true">4.1.23.</strong> SDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/zerokit-api.html"><strong aria-hidden="true">4.1.24.</strong> Zerokit API</a></li></ol></li><li class="chapter-item expanded "><a href="../../ift-ts/template.html"><strong aria-hidden="true">4.2.</strong> TEMPLATE</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Logos LIP</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/vacp2p/rfc-index" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="cryptarchia-proof-of-leadership"><a class="header" href="#cryptarchia-proof-of-leadership">CRYPTARCHIA-PROOF-OF-LEADERSHIP</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody>
<tr><td>Name</td><td>Cryptarchia Proof of Leadership Specification</td></tr>
<tr><td>Slug</td><td>83</td></tr>
<tr><td>Status</td><td>raw</td></tr>
<tr><td>Category</td><td>Standards Track</td></tr>
<tr><td>Editor</td><td>Thomas Lavaur <a href="mailto:thomas@status.im">thomas@status.im</a></td></tr>
<tr><td>Contributors</td><td>Mehmet <a href="mailto:mehmet@status.im">mehmet@status.im</a>, Giacomo Pasini <a href="mailto:giacomo@status.im">giacomo@status.im</a>, Daniel Sanchez Quiros <a href="mailto:daniel@status.im">daniel@status.im</a>, Álvaro Castro-Castilla <a href="mailto:alvaro@status.im">alvaro@status.im</a>, David Rusu <a href="mailto:david@status.im">david@status.im</a>, Filip Dimitrijevic <a href="mailto:filip@status.im">filip@status.im</a></td></tr>
</tbody></table>
</div><!-- timeline:start -->
<h2 id="timeline"><a class="header" href="#timeline">Timeline</a></h2>
<ul>
<li><strong>2026-01-19</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/f24e567d0b1e10c178bfa0c133495fe83b969b76/docs/blockchain/raw/cryptarchia-proof-of-leadership.md"><code>f24e567</code></a> — Chore/updates mdbook (#262)</li>
<li><strong>2026-01-16</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/89f2ea89fc1d69ab238b63c7e6fb9e4203fd8529/docs/blockchain/raw/cryptarchia-proof-of-leadership.md"><code>89f2ea8</code></a> — Chore/mdbook updates (#258)</li>
</ul>
<!-- timeline:end -->
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>The Proof of Leadership (PoL) enables a leader to produce a zero-knowledge proof
attesting to the fact that they have an eligible note (a representation of stake)
that has won the leadership lottery.
This proof is designed to be as lightweight as possible to generate and verify,
to impose minimal restrictions on access to the role of leader
and maximize the decentralization of that role.
This document specifies the PoL mechanism for Cryptarchia,
extending the work presented in the Ouroboros Crypsinous paper
with recent cryptographic developments.</p>
<p><strong>Keywords:</strong> Cryptarchia, proof-of-leadership, zero-knowledge, consensus,
note, stake, lottery, Merkle tree</p>
<h2 id="semantics"><a class="header" href="#semantics">Semantics</a></h2>
<p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>.</p>
<h2 id="background"><a class="header" href="#background">Background</a></h2>
<h3 id="protocol-overview"><a class="header" href="#protocol-overview">Protocol Overview</a></h3>
<p>The PoL mechanism ensures that a note has legitimately won the leadership election
while protecting the leader's privacy.
The protocol is comprised of two parts: setup and PoL generation.</p>
<p><strong>Setup:</strong></p>
<ol>
<li>Draw uniformly a random seed.</li>
<li>Construct a Merkle tree composed of slot secrets derived from the seed.</li>
<li>Use the root of the tree and the starting slot to get the leader's secret key.
The starting slot is when the note can start to be used for PoL.</li>
<li>The leader receives their stake in a note that uses this generated secret key.
The leader either transfers this stake to themselves
or obtains it from a different user.</li>
<li>The note becomes eligible for Proof of Stake (PoS) when it has aged sufficiently,
and the actual slot number is greater than or equal to
the starting slot of the note.</li>
</ol>
<p><strong>PoL generation:</strong></p>
<ol>
<li>First, check if the note is winning by simulating the lottery.</li>
<li>Prove the membership of the note identifier in an old snapshot of the Mantle Ledger,
proving its age and its existence.</li>
<li>Prove the membership of the note identifier in the most recent Mantle ledger,
proving it's unspent.</li>
<li>Prove that the note won the PoS lottery.</li>
<li>Prove the knowledge of the slot secret for the winning slot.</li>
<li>The proof is bound to a cryptographic public key used for signing
the leader's proposed blocks.</li>
</ol>
<h3 id="comparison-with-original-crypsinous-pol"><a class="header" href="#comparison-with-original-crypsinous-pol">Comparison with Original Crypsinous PoL</a></h3>
<p>This description differs from the original paper proposition,
proving that a note is unspent directly
instead of delegating the verification to validators.
This design choice brings the following tradeoffs:</p>
<p><strong>Advantages:</strong></p>
<ol>
<li>
<p>The ledger isn't required to be private using shielded notes.</p>
<ul>
<li>Validators don't need to maintain a nullifier list.</li>
<li>Leaders keep their privacy unlinking their stake, block and PoL.</li>
</ul>
</li>
<li>
<p>There is no leader note evolution mechanism anymore (see the paper for details).</p>
<ul>
<li>There are no orphan proofs anymore,
removing the need to include valid PoL proofs from abandoned forks.</li>
<li>Crypsinous required maintaining a parallel note commitment set
integrating evolving notes over time.
This requirement is removed now.</li>
<li>The derivation of the slot secret and its Merkle proof
can be done locally without connection to the Nomos chain.</li>
</ul>
</li>
</ol>
<p><strong>Disadvantages:</strong></p>
<ol>
<li>The PoL cannot be computed far in advance
because the leader MUST know the latest ledger state of Mantle.</li>
</ol>
<h2 id="protocol"><a class="header" href="#protocol">Protocol</a></h2>
<h3 id="protection-against-adaptive-adversaries"><a class="header" href="#protection-against-adaptive-adversaries">Protection Against Adaptive Adversaries</a></h3>
<p>The Ouroboros Crypsinous paper integrates protection against adaptive adversaries:</p>
<blockquote>
<p>The design has several subtleties since a critical consideration in the PoS setting
is tolerating adaptive corruptions:
this ensures that even if the adversary can corrupt parties
in the course of the protocol execution in an adaptive manner,
it does not gain any non-negligible advantage by e.g., re-issuing past PoS blocks.
(p. 2)</p>
</blockquote>
<p>To avoid a leaked note being reused to maliciously regenerate past PoLs,
this specification adopts the solution proposed in the paper
using slightly different parameters.</p>
<p>The solution proposed in the paper is as follows:</p>
<blockquote>
<p>We solve the former issue, by adding a cheap key-erasure scheme
into the NIZK for leadership proofs.
Specifically, <strong>parties have a Merkle tree of secret keys</strong>,
the root of which is hashed to create the corresponding public key.
The <strong>Merkle tree roots acts like a Zerocash coin secret key</strong>,
and can be used to spend coins.
For leadership however, parties also must prove knowledge of a path
in the Merkle tree to a leaf at the index of the slot they are claiming to lead.
<strong>After a slot passes, honest parties erase their preimages</strong>
of this part of that path in the tree.
As the size of this tree is linear with the number of slots,
we allow parties to keep it small, by restricting its size.
(p. 5)</p>
</blockquote>
<p>The paper proposed a tree of depth 24.</p>
<ul>
<li>This implies that the note is usable for PoS for only 194 days approximately
(because 1 slot is 1 second).</li>
<li>After this period, the note MUST be refreshed to include new randomness.
For simplicity, the refresh mechanism is designed
as a classical transaction modifying the nullifier secret key.</li>
<li>This solution has good performance:</li>
</ul>
<blockquote>
<p>For a reasonable value of $R = 2^{24}$, this is of little practical concern.
Public keys are valid for $2^{24}$ slots
and employing standard space/time trade-offs,
key updates take under 10,000 hashes, with less than 500kB storage requirement.
The most expensive part of the process, key generation,
still takes less than a minute on a modern CPU.
(p. 29)</p>
</blockquote>
<p>The disadvantages of this solution are that:</p>
<ol>
<li>The public key of the note will change periodically
(each time all slot secrets are consumed) for the ones participating in PoL.</li>
<li>The note will not be reusable directly after refresh
as only old enough notes are usable for PoS.</li>
</ol>
<p>This specification proposes a tree with a depth of 25,
extending the note's eligibility to around 388 days,
with a maximum of <strong>two epochs remaining ineligible</strong> not counted in these days.
Note that this requirement applies specifically to proving leadership in PoS
and is not needed for every note.
While any note can be used for PoL,
the knowledge of the secret slots behind the public key
is only necessary to demonstrate that you are a leader.</p>
<p><strong>Setup:</strong> When refreshing their notes, potential leaders will:</p>
<ol>
<li>
<p>Uniformly randomly draw a seed $r_1 \xleftarrow{$} \mathbb{F}_p$.</p>
</li>
<li>
<p>Construct a Merkle Tree of root $R$ containing $2^{25}$ slot secrets
(that are random numbers).
One way to efficiently construct the tree is to:</p>
<ul>
<li>
<p>Derive the slot secrets using a zkhash chain:
$\forall i \in [2, 2^{25}], r_i := \text{hash}(r_{i-1})$.</p>
<ul>
<li>More concretely, each leaf is the zkhash of the previous leaf (slot secret).</li>
</ul>
</li>
<li>
<p>This reduces storage requirements compared to directly randomly drawn
independently $2^{25}$ slot secrets.</p>
<ul>
<li>The first generation of the Merkle tree should be fast enough
as it only requires hashing data.
A correct implementation that erases data over time
could maintain an upper bound in memory usage during the generation
of the tree to only $\log_2(2^{25}) = 25$ zk hashes which is 800 bytes.</li>
<li>Leaders are only required to maintain the MMR up to the current slot.
This means at minimum,
leaders hold only 25 hashes in memory at any point in time.</li>
<li>After the first generation, the wallets optimize their storage
by holding only the necessary information to maintain a correct Merkle path,
deriving the next one over time using the fact that
slot secrets were derived from the previous ones.</li>
</ul>
</li>
<li>
<p>It guarantees protection against adaptive adversaries.</p>
<ul>
<li>Thanks to the pseudo-random properties of the hash function,
slot secrets are indistinguishable from true randomness.</li>
<li>The one-way property of the hash function guarantees
that an adaptive adversary cannot retrieve past slot secrets
using a fresher one.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>The user chooses a starting slot $sl_{start}$ from which their note
will be eligible for PoS.</p>
<p>The note MUST be on-chain by the start of epoch $ep - 1$
to be eligible for PoL in epoch $ep$ because of the age requirement.
Based on this, we suggest $sl_{start}$ to not be earlier
than the start of the epoch following the one after the transaction is emitted.
This prevents the inclusion of unusable slot secrets in the tree
(because the note would not be aged enough),
optimizing the PoL lifetime of the note.</p>
</li>
<li>
<p>Finally, they derive their secret key
$sk := \text{hash}(\text{NOMOS_POL_SK_V1}||sl_{start}||R)$,
binding the starting slot and the Merkle tree of slot secret
to the note secret key.
This is verified in Circuit Constraints.</p>
</li>
</ol>
<p>These four steps are summarized in the following pseudo-code:</p>
<pre><code class="language-python">def pol_sk_gen(sl_start, seed):
    frontier_nodes = MMR()
    path = MerkleProof()

    # Generate 2^25 slot secrets using a hash chain initialized with `seed`.
    r = zkhash(seed)
    for i in range(2**25):
        frontier_nodes.append(r)  # Append the slot secret to the MMR
        path.update(frontier_nodes)  # Update Merkle path of this slot secret
        r = zkhash(r)  # Derive the next slot secret

    # Derive the root of the MMR
    root = frontier_nodes.get_root()

    # Finally, derive the final PoL secret key.
    # Return the secret key and the Merkle proof of seed.
    return (zkhash(b"NOMOS_POL_SK_V1" + sl_start + root), path)

def update_secret_and_path(r, path):
    r = zkhash(r)  # Derive next slot secret
    path.update(r)  # Update the path for the Merkle proof of the new slot secret
    return (r, path)
</code></pre>
<blockquote>
<p>Note that the generation of the slot secret tree is not constrained
by proofs or at consensus level and can be adapted by the node
as long as they are able to derive the merkle proof of their slot secret.</p>
</blockquote>
<p><strong>PoL:</strong> When proving the leadership election,
note owners will prove knowledge of the slot secret corresponding to the slot $sl$.</p>
<ol>
<li>To do that, they will give a Merkle path from the leaf at index $sl - sl_{start}$.</li>
<li>The root of the tree hashed with $sl_{start}$ MUST be the secret key $sk$,
which will be used for public key derivation.</li>
</ol>
<p><strong>Protection against adaptive adversaries:</strong>
Since each slot has its own slot secret,
requiring wallets to delete slot secrets used for previous slots
avoids the risk of corruption that leads to the creation of PoL for previous blocks.</p>
<ul>
<li>The slot secret is derived from the previous one but the opposite is impossible.</li>
<li>An adaptive adversary corrupting the node would not have access to
previous slot secrets if correctly deleted.
Therefore, an adversary would not be able to generate the PoL for previous slots.</li>
</ul>
<h3 id="ledger-root"><a class="header" href="#ledger-root">Ledger Root</a></h3>
<p>In order to prove that the winning note exists in the ledger
and existed at the start of the previous epoch,
every node MUST compute two ledger commitments.
These commitments $ledger_{AGED}$ and $ledger_{LATEST}$
are Merkle roots constructed over the Note IDs.
The trees have a depth of 32 and are populated with note IDs.
The value 0 represents an empty leaf.
When the set is updated, during insertion,
the first empty leaf is replaced with the new note ID,
and during deletion, the leaf containing the deleted note ID is replaced with 0.</p>
<p>The following pseudo-code shows how the tree is managed:</p>
<pre><code class="language-python">def insert_new_note(note_set: list[NoteId], new_note: NoteId):
    i = 0
    while i &lt; len(note_set) and note_set[i] != 0:
        i += 1
    if i &lt; len(note_set):
        note_set[i] = new_note
    else:
        note_set.append(new_note)
    return note_set

def delete_note(note_set: list[NoteId], note: NoteId):
    i = 0
    while i &lt; len(note_set) and note_set[i] != note:
        i += 1
    if i == len(note_set):
        # note not in the set
        return note_set
    note_set[i] = 0
    return note_set

def empty_tree_root(depth: int):
    root = 0
    for i in range(depth):
        h = hasher()  # zk hash
        h.update(root)
        h.update(root)
        root = h.digest()
    return root

def get_ledger_root(note_set: list[NoteId]):
    assert(len(note_set) &lt; 2**32)
    ledger_root = get_merkle_root(note_set)
    # return the Merkle root of the set padded with 0 to next power of 2
    ledger_root_height = len(note_set).bit_length()
    for height in range(ledger_root_height, 32):
        h = Hasher()  # zk hash
        h.update(ledger_root)
        h.update(empty_tree_root(height))
        ledger_root = h.digest()
    return ledger_root
</code></pre>
<blockquote>
<p>The ledger root may not be unique because the note IDs set can cycle.
Indeed, even if it's not possible to insert the same note ID twice,
it's possible to cycle on a previous set state by removing notes.
However, note IDs uniqueness guarantees protection against attacks on note aging.</p>
</blockquote>
<h3 id="zero-knowledge-proof-statement"><a class="header" href="#zero-knowledge-proof-statement">Zero-knowledge Proof Statement</a></h3>
<p><img src="assets/pol-short-diagram.webp" alt="Proof of Leadership Circuit Diagram" /></p>
<h4 id="circuit-public-inputs"><a class="header" href="#circuit-public-inputs">Circuit Public Inputs</a></h4>
<p>The prover (the leader) and the verifiers (nodes of the chain)
MUST agree on these values:</p>
<ol>
<li>
<p><strong>The slot number:</strong> $sl$.</p>
</li>
<li>
<p><strong>The epoch nonce:</strong> $\eta$.</p>
<ul>
<li>For details see Cryptarchia v1 Protocol Specification - Epoch Nonce.</li>
</ul>
</li>
<li>
<p><strong>The lottery function constants:</strong>
$t_0 = -\frac{\text{VRF_order} \cdot \ln(1-f)}{\text{inferred_total_stake}}$
and
$t_1 = -\frac{\text{VRF_order} \cdot \ln^2(1-f)}{2 \cdot \text{inferred_total_stake}^2}$.</p>
<ul>
<li>For details see Lottery Approximation.</li>
<li>These numbers MUST be computed with high precision outside the proof.</li>
</ul>
</li>
<li>
<p><strong>The root of the note Merkle tree when the stake distribution was frozen:</strong>
$ledger_{AGED}$.</p>
<ul>
<li>For details see Cryptarchia v1 Protocol Specification - Epoch State Pseudocode.</li>
</ul>
</li>
<li>
<p><strong>The latest root of the note Merkle tree:</strong> $ledger_{LATEST}$.</p>
<ul>
<li>Used to ensure the leadership note has not been spent.</li>
</ul>
</li>
<li>
<p><strong>The leader's one-time public key</strong> $P_{LEAD}$
represented by 2 public inputs, each of 16 bytes in little endian.
This key is needed to sign the proposed block.</p>
<ul>
<li>For details see Linking the Proof of Leadership to a Block.</li>
</ul>
</li>
<li>
<p><strong>The entropy contribution</strong> $\rho_{LEAD}$ verified to be correctly derived.</p>
<ul>
<li>This is the epoch nonce entropy contribution.
See Cryptarchia v1 Protocol Specification - Epoch Nonce.</li>
</ul>
</li>
</ol>
<h4 id="circuit-private-inputs"><a class="header" href="#circuit-private-inputs">Circuit Private Inputs</a></h4>
<p>The prover has to provide these values, but they remain secret:</p>
<ol>
<li>
<p><strong>The slot secret and the related information</strong> used for the slot $sl$
as described in Protection Against Adaptive Adversaries:</p>
<ul>
<li>The slot secret $r_{sl}$.</li>
<li>The Merkle path $slot_secret_path$ of $r_{sl}$ leading to the root $R$.</li>
<li>The starting secret slot $sl_{start}$.</li>
</ul>
</li>
<li>
<p><strong>The eligible note and its related information</strong> used to derive the $noteID$
(the secret key is derived for the previous step):</p>
<ul>
<li>The note value: $v$.</li>
<li>The note transaction zk hash: $note_tx_hash$.</li>
<li>The note outputs number: $note_output_number$.</li>
</ul>
</li>
<li>
<p><strong>The proof of membership</strong> of the note identifier in the zone ledgers
$ledger_{AGED}$ and $ledger_{LATEST}$.
This is done by providing the complementary Merkle nodes
and indicating whether they are left (0) or right (1) through boolean selectors:</p>
<ul>
<li>The aged ledger complementary nodes: $noteid_aged_path$.</li>
<li>The aged ledger complementary node selectors: $note_id_aged_selectors$.</li>
<li>The latest ledger complementary nodes: $noteid_latest_path$.</li>
<li>The latest ledger complementary node selectors: $note_id_latest_selectors$.</li>
</ul>
</li>
</ol>
<h4 id="circuit-constraints"><a class="header" href="#circuit-constraints">Circuit Constraints</a></h4>
<p>The proof confirms the following relations:</p>
<ol>
<li>
<p>The derivation of the Merkle tree root $R$
using the slot secret $r_{sl}$ as the $sl - sl_{start}$'s leaf
of the Merkle tree using the Merkle path.</p>
<p>This is a proof of knowledge of the secret slot $r_{sl}$
guaranteeing protection against adaptive adversaries.</p>
</li>
<li>
<p>The derivation of $sk = \text{hash}(\text{NOMOS_POL_SK_V1}||sl_{start}||R)$,
as documented in Protection Against Adaptive Adversaries.</p>
</li>
<li>
<p>The computation of the note identifier.</p>
</li>
<li>
<p>The note identifier is in $ledger_{AGED}$ and $ledger_{LATEST}$.</p>
</li>
<li>
<p>The computation of the lottery ticket:
$ticket := \text{hash}(\text{LEAD_V1}||\eta||sl||noteID||sk)$ using Poseidon2.</p>
</li>
<li>
<p>The computation of the threshold: $t := v(t_0 + t_1 \cdot v)$.
The ticket MUST be lower than this threshold to win the lottery.</p>
</li>
<li>
<p>The check that indeed $ticket &lt; t$.</p>
</li>
<li>
<p>Compute and output the entropy contribution
$\rho_{LEAD} := \text{hash}(\text{NOMOS_NONCE_CONTRIB_V1}||sl||noteID||sk)$.</p>
</li>
</ol>
<h3 id="linking-the-proof-of-leadership-to-a-block"><a class="header" href="#linking-the-proof-of-leadership-to-a-block">Linking the Proof of Leadership to a Block</a></h3>
<p>The PoL is bound to a public key from an asymmetric signature scheme.
This public key $P_{LEAD}$ is given as two public inputs during the PoL proof generation,
binding the proof to the key.</p>
<ul>
<li>The public key is represented by two public inputs of 16 bytes
to guarantee the support of every possible EdDSA25519 public key.</li>
<li>This public key is later used to verify the signature $\sigma$ of a block
when it is dispersed.
This ensures that the PoL is tied to a specific block,
and only the entity creating the proof can perform this binding.</li>
<li>The key is single-use, as reusing the same one could allow multiple PoLs
to be linked to the same identity.
An observer could then infer the stake of that identity
by observing the frequency at which it emits a PoL.</li>
</ul>
<h2 id="appendix"><a class="header" href="#appendix">Appendix</a></h2>
<h3 id="lottery-approximation"><a class="header" href="#lottery-approximation">Lottery Approximation</a></h3>
<ul>
<li>The $\phi_f(\alpha) = 1 - (1-f)^\alpha$ function of Ouroboros Crypsinous
cannot be computed in a hand-written circuit
as it can only operate on elements of $\mathbb{F}_p$
for a certain prime number $p$.</li>
<li>Managing floating point numbers and mathematical functions
involving floating points like exponentiations or logarithms in circuits
is very inefficient.</li>
<li>Comparing the Taylor expansion of order 1 and 2,
the Taylor expansion of order 2 method is used
to approximate the Ouroboros Genesis (and Crypsinous) function
by the following linear function:
<ul>
<li>$\stackrel{0}{\sim}$ means nearly equal in the neighborhood of 0</li>
<li>$f$ is the probability that at least one leader wins the lottery on each slot</li>
<li>$x$ is the stake of the proven note</li>
</ul>
</li>
</ul>
<p>$$1 - (1-f)^x = 1 - e^{x \ln(1-f)}$$</p>
<p>$$1 - e^{x \ln(1-f)} \stackrel{0}{\sim} x(-\ln(1-f) - 0.5 \ln^2(1-f)x)$$</p>
<p>Then the threshold is $stake(t_0 + t_1 \cdot stake)$ with
$t_0 := -\frac{\text{VRF_order} \cdot \ln(1-f)}{\text{inferred_total_stake}}$
and
$t_1 := -\frac{\text{VRF_order} \cdot \ln^2(1-f)}{2 \cdot \text{inferred_total_stake}^2}$.</p>
<p>Since everything is known by every node except the value of the staked note,
we pre-compute $t_0$ and $t_1$ outside of the circuit.</p>
<ul>
<li>The Hash functions used to derive the lottery ticket is Poseidon2
so the VRF_order is $p$ the order of the scalar field of the BN254 elliptic curve.</li>
<li>To compute $t_0$ and $t_1$, we precomputed the constant parts using sagemath
and real number of 512 bits precision.
In the implementation, $t_0$ and $t_1$ should then be derived
using 256-bit precision integers following:</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Variable</th><th>Formula</th></tr></thead><tbody>
<tr><td>$p$</td><td><code>0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001</code></td></tr>
<tr><td>$t_0_constant$</td><td><code>0x1a3fb997fd58374772808c13d1c2ddacb5ab3ea77413f86fd6e0d3d978e5438</code></td></tr>
<tr><td>$t_1_constant$</td><td><code>0x71e790b41991052e30c93934b5612412e7958837bac8b1c524c24d84cc7d0</code></td></tr>
<tr><td>$t_0$</td><td>$\frac{t_0_constant}{\text{inferred_total_stake}}$</td></tr>
<tr><td>$t_1$</td><td>$p - \lfloor\frac{t_1_constant}{\text{inferred_total_stake}^2}\rfloor$</td></tr>
</tbody></table>
</div>
<h3 id="error-analysis"><a class="header" href="#error-analysis">Error Analysis</a></h3>
<ul>
<li>For $f = 0.05$.
The error percentage is computed with $100 \cdot \frac{estimation - real_value}{real_value}$.</li>
<li>This analysis considers inferred_total_stake to be 23.5B as in Cardano.</li>
<li>Original function: $1 - (1-f)^{\frac{stake}{\text{inferred_total_stake}}}$</li>
<li>Taylor expansion of order 1:
$-\frac{stake}{\text{inferred_total_stake}} \ln(1-f) := stake \cdot t_0$</li>
<li>Taylor expansion of order 2:
$\frac{stake}{\text{inferred_total_stake}}(-\ln(1-f) - 0.5 \ln^2(1-f)(\frac{stake}{\text{inferred_total_stake}})) := stake(t_0 + stake \cdot t_1)$</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>stake (%)</th><th>order 1 error</th><th>order 2 error</th></tr></thead><tbody>
<tr><td>5%</td><td>0.13%</td><td>-0.0001%</td></tr>
<tr><td>10%</td><td>0.26%</td><td>-0.0004%</td></tr>
<tr><td>15%</td><td>0.39%</td><td>-0.0010%</td></tr>
<tr><td>20%</td><td>0.51%</td><td>-0.0018%</td></tr>
<tr><td>25%</td><td>0.64%</td><td>-0.0027%</td></tr>
<tr><td>30%</td><td>0.77%</td><td>-0.0040%</td></tr>
<tr><td>35%</td><td>0.90%</td><td>-0.0054%</td></tr>
<tr><td>40%</td><td>1.03%</td><td>-0.0071%</td></tr>
<tr><td>45%</td><td>1.16%</td><td>-0.0089%</td></tr>
<tr><td>50%</td><td>1.29%</td><td>-0.0110%</td></tr>
<tr><td>55%</td><td>1.42%</td><td>-0.0134%</td></tr>
<tr><td>60%</td><td>1.55%</td><td>-0.0159%</td></tr>
<tr><td>65%</td><td>1.68%</td><td>-0.0187%</td></tr>
<tr><td>70%</td><td>1.81%</td><td>-0.0217%</td></tr>
<tr><td>75%</td><td>1.94%</td><td>-0.0249%</td></tr>
<tr><td>80%</td><td>2.07%</td><td>-0.0284%</td></tr>
<tr><td>85%</td><td>2.20%</td><td>-0.0320%</td></tr>
<tr><td>90%</td><td>2.33%</td><td>-0.0359%</td></tr>
<tr><td>95%</td><td>2.46%</td><td>-0.0406%</td></tr>
<tr><td>100%</td><td>2.59%</td><td>-0.0444%</td></tr>
</tbody></table>
</div>
<h3 id="benchmarks"><a class="header" href="#benchmarks">Benchmarks</a></h3>
<p>The material used for the benchmarks is the following:</p>
<ul>
<li>CPU: 13th Gen Intel(R) Core(TM) i9-13980HX (24 cores / 32 threads)</li>
<li>RAM: 32GB - Speed: 5600 MT/s</li>
<li>Motherboard: Micro-Star International Co., Ltd. MS-17S1</li>
<li>OS: Ubuntu 22.04.5 LTS</li>
<li>Kernel: 6.8.0-59-generic</li>
</ul>
<p><img src="assets/pol-benchmark-proving-time.webp" alt="Average proving time vs number of threads (100 Runs)" /></p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<h3 id="normative"><a class="header" href="#normative">Normative</a></h3>
<ul>
<li><a href="https://nomos-tech.notion.site/Cryptarchia-v1-Protocol-Specification-21c261aa09df810cb85eff1c76e5798c">Cryptarchia v1 Protocol Specification</a>
- Parent protocol specification</li>
</ul>
<h3 id="informative"><a class="header" href="#informative">Informative</a></h3>
<ul>
<li><a href="https://nomos-tech.notion.site/Proof-of-Leadership-Specification-21c261aa09df819ba5b6d95d0fe3066d">Proof of Leadership Specification</a>
- Original Proof of Leadership documentation</li>
<li><a href="https://eprint.iacr.org/2018/1132.pdf">Ouroboros Crypsinous: Privacy-Preserving Proof-of-Stake</a>
- Foundation for the PoL design</li>
</ul>
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p>Copyright and related rights waived via <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../blockchain/raw/fork-choice.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../blockchain/raw/cryptarchia-total-stake-inference.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../blockchain/raw/fork-choice.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../blockchain/raw/cryptarchia-total-stake-inference.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../scripts/rfc-index.js"></script>


    </div>
    </body>
</html>
