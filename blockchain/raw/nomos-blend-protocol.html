<!DOCTYPE HTML>
<html lang="en" class="ayu" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>NOMOS-BLEND-PROTOCOL - Logos LIP</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../theme/fonts/fonts.css">
        <link rel="stylesheet" href="../../theme/FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('ayu')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../index.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../../about.html">About</a></li><li class="chapter-item expanded "><a href="../../messaging/index.html"><strong aria-hidden="true">1.</strong> Messaging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/index.html"><strong aria-hidden="true">1.1.</strong> Standards - Core</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/10/waku2.html"><strong aria-hidden="true">1.1.1.</strong> 10/WAKU2</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/11/relay.html"><strong aria-hidden="true">1.1.2.</strong> 11/WAKU2-RELAY</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/12/filter.html"><strong aria-hidden="true">1.1.3.</strong> 12/WAKU2-FILTER</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/12/previous-versions/00/filter.html"><strong aria-hidden="true">1.1.3.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/13/store.html"><strong aria-hidden="true">1.1.4.</strong> 13/WAKU2-STORE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/core/13/previous-versions/00/store.html"><strong aria-hidden="true">1.1.4.1.</strong> 00 (previous)</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/14/message.html"><strong aria-hidden="true">1.1.5.</strong> 14/WAKU2-MESSAGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/15/bridge.html"><strong aria-hidden="true">1.1.6.</strong> 15/WAKU-BRIDGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/17/rln-relay.html"><strong aria-hidden="true">1.1.7.</strong> 17/WAKU2-RLN-RELAY</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/19/lightpush.html"><strong aria-hidden="true">1.1.8.</strong> 19/WAKU2-LIGHTPUSH</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/31/enr.html"><strong aria-hidden="true">1.1.9.</strong> 31/WAKU2-ENR</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/33/discv5.html"><strong aria-hidden="true">1.1.10.</strong> 33/WAKU2-DISCV5</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/34/peer-exchange.html"><strong aria-hidden="true">1.1.11.</strong> 34/WAKU2-PEER-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/36/bindings-api.html"><strong aria-hidden="true">1.1.12.</strong> 36/WAKU2-BINDINGS-API</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/64/network.html"><strong aria-hidden="true">1.1.13.</strong> 64/WAKU2-NETWORK</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/core/66/metadata.html"><strong aria-hidden="true">1.1.14.</strong> 66/WAKU2-METADATA</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/index.html"><strong aria-hidden="true">1.2.</strong> Standards - Application</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/application/20/toy-eth-pm.html"><strong aria-hidden="true">1.2.1.</strong> 20/TOY-ETH-PM</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/26/payload.html"><strong aria-hidden="true">1.2.2.</strong> 26/WAKU2-PAYLOAD</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/53/x3dh.html"><strong aria-hidden="true">1.2.3.</strong> 53/WAKU2-X3DH</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/application/54/x3dh-sessions.html"><strong aria-hidden="true">1.2.4.</strong> 54/WAKU2-X3DH-SESSIONS</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/index.html"><strong aria-hidden="true">1.3.</strong> Standards - Legacy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/6/waku1.html"><strong aria-hidden="true">1.3.1.</strong> 6/WAKU1</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/7/data.html"><strong aria-hidden="true">1.3.2.</strong> 7/WAKU-DATA</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/8/mail.html"><strong aria-hidden="true">1.3.3.</strong> 8/WAKU-MAIL</a></li><li class="chapter-item expanded "><a href="../../messaging/standards/legacy/9/rpc.html"><strong aria-hidden="true">1.3.4.</strong> 9/WAKU-RPC</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/informational/index.html"><strong aria-hidden="true">1.4.</strong> Informational</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/informational/22/toy-chat.html"><strong aria-hidden="true">1.4.1.</strong> 22/TOY-CHAT</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/23/topics.html"><strong aria-hidden="true">1.4.2.</strong> 23/WAKU2-TOPICS</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/27/peers.html"><strong aria-hidden="true">1.4.3.</strong> 27/WAKU2-PEERS</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/29/config.html"><strong aria-hidden="true">1.4.4.</strong> 29/WAKU2-CONFIG</a></li><li class="chapter-item expanded "><a href="../../messaging/informational/30/adaptive-nodes.html"><strong aria-hidden="true">1.4.5.</strong> 30/ADAPTIVE-NODES</a></li></ol></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/index.html"><strong aria-hidden="true">1.5.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../messaging/deprecated/5/waku0.html"><strong aria-hidden="true">1.5.1.</strong> 5/WAKU0</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/16/rpc.html"><strong aria-hidden="true">1.5.2.</strong> 16/WAKU2-RPC</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/18/swap.html"><strong aria-hidden="true">1.5.3.</strong> 18/WAKU2-SWAP</a></li><li class="chapter-item expanded "><a href="../../messaging/deprecated/fault-tolerant-store.html"><strong aria-hidden="true">1.5.4.</strong> 21/WAKU2-FAULT-TOLERANT-STORE</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../blockchain/index.html"><strong aria-hidden="true">2.</strong> Blockchain</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/raw/index.html"><strong aria-hidden="true">2.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-anonymous-leaders-reward.html"><strong aria-hidden="true">2.1.1.</strong> BEDROCK-ANONYMOUS-LEADERS-REWARD</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-architecture-overview.html"><strong aria-hidden="true">2.1.2.</strong> BEDROCK-ARCHITECTURE-OVERVIEW</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-genesis-block.html"><strong aria-hidden="true">2.1.3.</strong> BEDROCK-GENESIS-BLOCK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-service-declaration-protocol.html"><strong aria-hidden="true">2.1.4.</strong> BEDROCK-SERVICE-DECLARATION-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-service-reward-distribution.html"><strong aria-hidden="true">2.1.5.</strong> BEDROCK-SERVICE-REWARD-DISTRIBUTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-v1.1-block-construction.html"><strong aria-hidden="true">2.1.6.</strong> BEDROCK-V1-1-BLOCK-CONSTRUCTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/bedrock-v1.1-mantle-specification.html"><strong aria-hidden="true">2.1.7.</strong> BEDROCK-V1.1-MANTLE-SPECIFICATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/fork-choice.html"><strong aria-hidden="true">2.1.8.</strong> CRYPTARCHIA-FORK-CHOICE</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-proof-of-leadership.html"><strong aria-hidden="true">2.1.9.</strong> CRYPTARCHIA-PROOF-OF-LEADERSHIP</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-total-stake-inference.html"><strong aria-hidden="true">2.1.10.</strong> CRYPTARCHIA-TOTAL-STAKE-INFERENCE</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/cryptarchia-v1-bootstr-sync.html"><strong aria-hidden="true">2.1.11.</strong> CRYPTARCHIA-V1-BOOTSTRAPPING-SYNCHRONIZATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-blend-protocol.html" class="active"><strong aria-hidden="true">2.1.12.</strong> NOMOS-BLEND-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-cryptarchia-v1-protocol.html"><strong aria-hidden="true">2.1.13.</strong> NOMOS-CRYPTARCHIA-V1-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomosda-network.html"><strong aria-hidden="true">2.1.14.</strong> NOMOS-DA-NETWORK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-key-types-and-generation.html"><strong aria-hidden="true">2.1.15.</strong> NOMOS-KEY-TYPES-GENERATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-message-encapsulation.html"><strong aria-hidden="true">2.1.16.</strong> NOMOS-MESSAGE-ENCAPSULATION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-message-formatting.html"><strong aria-hidden="true">2.1.17.</strong> NOMOS-MESSAGE-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-network.html"><strong aria-hidden="true">2.1.18.</strong> NOMOS-P2P-NETWORK</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-payload-formatting.html"><strong aria-hidden="true">2.1.19.</strong> NOMOS-PAYLOAD-FORMATTING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/nomos-proof-of-quota.html"><strong aria-hidden="true">2.1.20.</strong> NOMOS-PROOF-OF-QUOTA</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/da-cryptographic-protocol.html"><strong aria-hidden="true">2.1.21.</strong> NOMOSDA-CRYPTOGRAPHIC-PROTOCOL</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/da-rewarding.html"><strong aria-hidden="true">2.1.22.</strong> NOMOSDA-REWARDING</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-hardware-requirements.html"><strong aria-hidden="true">2.1.23.</strong> P2P-HARDWARE-REQUIREMENTS</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-nat-solution.html"><strong aria-hidden="true">2.1.24.</strong> P2P-NAT-SOLUTION</a></li><li class="chapter-item expanded "><a href="../../blockchain/raw/p2p-network-bootstrapping.html"><strong aria-hidden="true">2.1.25.</strong> P2P-NETWORK-BOOTSTRAPPING</a></li></ol></li><li class="chapter-item expanded "><a href="../../blockchain/deprecated/index.html"><strong aria-hidden="true">2.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../blockchain/deprecated/claro.html"><strong aria-hidden="true">2.2.1.</strong> CONSENSUS-CLARO</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../storage/index.html"><strong aria-hidden="true">3.</strong> Storage</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/raw/index.html"><strong aria-hidden="true">3.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/raw/codex-block-exchange.html"><strong aria-hidden="true">3.1.1.</strong> CODEX-BLOCK-EXCHANGE</a></li><li class="chapter-item expanded "><a href="../../storage/raw/community-history.html"><strong aria-hidden="true">3.1.2.</strong> CODEX-COMMUNITY-HISTORY</a></li><li class="chapter-item expanded "><a href="../../storage/raw/dht.html"><strong aria-hidden="true">3.1.3.</strong> CODEX-DHT</a></li><li class="chapter-item expanded "><a href="../../storage/raw/codex-merkle-tree.html"><strong aria-hidden="true">3.1.4.</strong> CODEX-MERKLE-TREE</a></li><li class="chapter-item expanded "><a href="../../storage/raw/codex-store.html"><strong aria-hidden="true">3.1.5.</strong> CODEX-STORE</a></li></ol></li><li class="chapter-item expanded "><a href="../../storage/deprecated/index.html"><strong aria-hidden="true">3.2.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../storage/deprecated/erasure-coding.html"><strong aria-hidden="true">3.2.1.</strong> CODEX-ERASUE-CODING</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/codex-marketplace.html"><strong aria-hidden="true">3.2.2.</strong> CODEX-MARKETPLACE</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/codex-prover.html"><strong aria-hidden="true">3.2.3.</strong> CODEX-PROVER</a></li><li class="chapter-item expanded "><a href="../../storage/deprecated/slot-buIlder.html"><strong aria-hidden="true">3.2.4.</strong> CODEX-SLOT-BUILDER</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../ift-ts/index.html"><strong aria-hidden="true">4.</strong> IFT-TS</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ift-ts/raw/index.html"><strong aria-hidden="true">4.1.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ift-ts/raw/1/coss.html"><strong aria-hidden="true">4.1.1.</strong> 1/COSS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/2/mvds.html"><strong aria-hidden="true">4.1.2.</strong> 2/MVDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/3/remote-log.html"><strong aria-hidden="true">4.1.3.</strong> 3/REMOTE-LOG</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/4/mvds-meta.html"><strong aria-hidden="true">4.1.4.</strong> 4/MVDS-META</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/25/libp2p-dns-discovery.html"><strong aria-hidden="true">4.1.5.</strong> 25/LIBP2P-DNS-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/32/rln-v1.html"><strong aria-hidden="true">4.1.6.</strong> 32/RLN-V1</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/decentralized-messaging-ethereum.html"><strong aria-hidden="true">4.1.7.</strong> ETH-DCGKA</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/eth-mls-offchain.html"><strong aria-hidden="true">4.1.8.</strong> ETH-MLS-OFFCHAIN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/eth-mls-onchain.html"><strong aria-hidden="true">4.1.9.</strong> ETH-MLS-ONCHAIN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/deleted/eth-secpm.html"><strong aria-hidden="true">4.1.10.</strong> ETH-SECPM</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/extended-kad-disco.html"><strong aria-hidden="true">4.1.11.</strong> EXTENDED-KADEMLIA-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/extensible-peer-records.html"><strong aria-hidden="true">4.1.12.</strong> EXTENSIBLE-PEER-RECORDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/gossipsub-tor-push.html"><strong aria-hidden="true">4.1.13.</strong> GOSSIPSUB-TOR-PUSH</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/consensus-hashgraphlike.html"><strong aria-hidden="true">4.1.14.</strong> HASHGRAPHLIKE CONSENSUS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/logos-capability-discovery.html"><strong aria-hidden="true">4.1.15.</strong> LOGOS-CAPABILITY-DISCOVERY</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/mix.html"><strong aria-hidden="true">4.1.16.</strong> MIX</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/multi-message_id-burn-rln.html"><strong aria-hidden="true">4.1.17.</strong> Multi-message_id Burn RLN</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/noise-x3dh-double-ratchet.html"><strong aria-hidden="true">4.1.18.</strong> NOISE-X3DH-DOUBLE-RATCHET</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/mix-spam-protection-rln.html"><strong aria-hidden="true">4.1.19.</strong> RLN DoS Protection for Mixnet</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-interep-spec.html"><strong aria-hidden="true">4.1.20.</strong> RLN-INTEREP-SPEC</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-stealth-commitments.html"><strong aria-hidden="true">4.1.21.</strong> RLN-STEALTH-COMMITMENTS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/rln-v2.html"><strong aria-hidden="true">4.1.22.</strong> RLN-V2</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/sds.html"><strong aria-hidden="true">4.1.23.</strong> SDS</a></li><li class="chapter-item expanded "><a href="../../ift-ts/raw/zerokit-api.html"><strong aria-hidden="true">4.1.24.</strong> Zerokit API</a></li></ol></li><li class="chapter-item expanded "><a href="../../ift-ts/template.html"><strong aria-hidden="true">4.2.</strong> TEMPLATE</a></li></ol></li><li class="chapter-item expanded "><a href="../../archived/index.html"><strong aria-hidden="true">5.</strong> Archived</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../archived/status/index.html"><strong aria-hidden="true">5.1.</strong> Status</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../archived/status/24/curation.html"><strong aria-hidden="true">5.1.1.</strong> 24/STATUS-CURATION</a></li><li class="chapter-item expanded "><a href="../../archived/status/28/featuring.html"><strong aria-hidden="true">5.1.2.</strong> 28/STATUS-FEATURING</a></li><li class="chapter-item expanded "><a href="../../archived/status/55/1to1-chat.html"><strong aria-hidden="true">5.1.3.</strong> 55/STATUS-1TO1-CHAT</a></li><li class="chapter-item expanded "><a href="../../archived/status/56/communities.html"><strong aria-hidden="true">5.1.4.</strong> 56/STATUS-COMMUNITIES</a></li><li class="chapter-item expanded "><a href="../../archived/status/61/community-history-service.html"><strong aria-hidden="true">5.1.5.</strong> 61/STATUS-Community-History-Service</a></li><li class="chapter-item expanded "><a href="../../archived/status/62/payloads.html"><strong aria-hidden="true">5.1.6.</strong> 62/STATUS-PAYLOADS</a></li><li class="chapter-item expanded "><a href="../../archived/status/63/keycard-usage.html"><strong aria-hidden="true">5.1.7.</strong> 63/STATUS-Keycard-Usage</a></li><li class="chapter-item expanded "><a href="../../archived/status/65/account-address.html"><strong aria-hidden="true">5.1.8.</strong> 65/STATUS-ACCOUNT-ADDRESS</a></li><li class="chapter-item expanded "><a href="../../archived/status/71/push-notification-server.html"><strong aria-hidden="true">5.1.9.</strong> 71/STATUS-PUSH-NOTIFICATION-SERVER</a></li><li class="chapter-item expanded "><a href="../../archived/status/raw/index.html"><strong aria-hidden="true">5.1.10.</strong> Raw</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../archived/status/raw/status-mvds.html"><strong aria-hidden="true">5.1.10.1.</strong> STATUS-MVDS-USAGE</a></li><li class="chapter-item expanded "><a href="../../archived/status/raw/status-app-protocols.html"><strong aria-hidden="true">5.1.10.2.</strong> STATUS-PROTOCOLS</a></li><li class="chapter-item expanded "><a href="../../archived/status/raw/simple-scaling.html"><strong aria-hidden="true">5.1.10.3.</strong> STATUS-SIMPLE-SCALING</a></li><li class="chapter-item expanded "><a href="../../archived/status/raw/url-data.html"><strong aria-hidden="true">5.1.10.4.</strong> STATUS-URL-DATA</a></li><li class="chapter-item expanded "><a href="../../archived/status/raw/url-scheme.html"><strong aria-hidden="true">5.1.10.5.</strong> STATUS-URL-SCHEME</a></li></ol></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/index.html"><strong aria-hidden="true">5.1.11.</strong> Deprecated</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../archived/status/deprecated/3rd-party.html"><strong aria-hidden="true">5.1.11.1.</strong> 3RD-PARTY</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/account.html"><strong aria-hidden="true">5.1.11.2.</strong> ACCOUNT</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/client.html"><strong aria-hidden="true">5.1.11.3.</strong> CLIENT</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/dapp-browser-API-usage.html"><strong aria-hidden="true">5.1.11.4.</strong> Dapp browser API usage</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/eips.html"><strong aria-hidden="true">5.1.11.5.</strong> EIPS</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/ethereum-usage.html"><strong aria-hidden="true">5.1.11.6.</strong> ETHEREUM-USAGE</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/group-chat.html"><strong aria-hidden="true">5.1.11.7.</strong> GROUP-CHAT</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/IPFS-gateway-for-sticker-Pack.html"><strong aria-hidden="true">5.1.11.8.</strong> IPFS-gateway-for-Sticker-Pack</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/keycard-usage-for-wallet-and-chat-keys.html"><strong aria-hidden="true">5.1.11.9.</strong> Keycard Usage for Wallet and Chat Keys</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/notifications.html"><strong aria-hidden="true">5.1.11.10.</strong> NOTIFICATIONS</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/payloads.html"><strong aria-hidden="true">5.1.11.11.</strong> PAYLOADS</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/push-notification-server.html"><strong aria-hidden="true">5.1.11.12.</strong> PUSH-NOTIFICATION-SERVER</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/secure-transport.html"><strong aria-hidden="true">5.1.11.13.</strong> SECURE-TRANSPORT</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/waku-mailserver.html"><strong aria-hidden="true">5.1.11.14.</strong> WAKU-MAILSERVER</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/waku-usage.html"><strong aria-hidden="true">5.1.11.15.</strong> WAKU-USAGE</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/whisper-mailserver.html"><strong aria-hidden="true">5.1.11.16.</strong> WHISPER-MAILSERVER</a></li><li class="chapter-item expanded "><a href="../../archived/status/deprecated/whisper-usage.html"><strong aria-hidden="true">5.1.11.17.</strong> WHISPER-USAGE</a></li></ol></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Logos LIP</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/vacp2p/rfc-index" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="nomos-blend-protocol"><a class="header" href="#nomos-blend-protocol">NOMOS-BLEND-PROTOCOL</a></h1>
<div class="table-wrapper"><table><thead><tr><th>Field</th><th>Value</th></tr></thead><tbody>
<tr><td>Name</td><td>Nomos Blend Protocol</td></tr>
<tr><td>Slug</td><td>95</td></tr>
<tr><td>Status</td><td>raw</td></tr>
<tr><td>Category</td><td>Standards Track</td></tr>
<tr><td>Editor</td><td>Marcin Pawlowski</td></tr>
<tr><td>Contributors</td><td>Alexander Mozeika <a href="mailto:alexander.mozeika@status.im">alexander.mozeika@status.im</a>, Youngjoon Lee <a href="mailto:youngjoon@status.im">youngjoon@status.im</a>, Frederico Teixeira <a href="mailto:frederico@status.im">frederico@status.im</a>, Mehmet Gonen <a href="mailto:mehmet@status.im">mehmet@status.im</a>, Daniel Sanchez Quiros <a href="mailto:danielsq@status.im">danielsq@status.im</a>, Álvaro Castro-Castilla <a href="mailto:alvaro@status.im">alvaro@status.im</a>, Daniel Kashepava <a href="mailto:danielkashepava@status.im">danielkashepava@status.im</a>, Thomas Lavaur <a href="mailto:thomaslavaur@status.im">thomaslavaur@status.im</a>, Antonio Antonino <a href="mailto:antonio@status.im">antonio@status.im</a>, Filip Dimitrijevic <a href="mailto:filip@status.im">filip@status.im</a></td></tr>
</tbody></table>
</div><!-- timeline:start -->
<h2 id="timeline"><a class="header" href="#timeline">Timeline</a></h2>
<ul>
<li><strong>2026-01-19</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/f24e567d0b1e10c178bfa0c133495fe83b969b76/docs/blockchain/raw/nomos-blend-protocol.md"><code>f24e567</code></a> — Chore/updates mdbook (#262)</li>
<li><strong>2026-01-16</strong> — <a href="https://github.com/vacp2p/rfc-index/blob/89f2ea89fc1d69ab238b63c7e6fb9e4203fd8529/docs/blockchain/raw/nomos-blend-protocol.md"><code>89f2ea8</code></a> — Chore/mdbook updates (#258)</li>
</ul>
<!-- timeline:end -->
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>The Blend Protocol is an anonymous broadcasting protocol for the Nomos network that provides network-level privacy for block proposers.
It addresses network-based de-anonymization by making it difficult and costly to link block proposals to their proposers through network analysis.
The protocol increases the time to link a sender to a proposal by at least 300 times,
making stake inference highly impractical.</p>
<p>The protocol achieves probabilistic unlinkability in a highly decentralized environment with low bandwidth cost but high latency.
It hides the sender of a block proposal through cryptographic obfuscation and timing delays,
routing encrypted messages through multiple blend nodes before revelation.</p>
<p><strong>Keywords:</strong> Blend, anonymous broadcasting, privacy, mix network,
unlinkability, stake privacy, encryption</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>All Proof of Stake (PoS) systems have an inherent privacy problem where stake determines node behavior.
By observing node behavior,
one can infer the node's stake.
The Blend Protocol addresses network-based de-anonymization where an adversary observes network activity to link nodes to their proposals and estimate stake.</p>
<p>The protocol achieves:</p>
<ol>
<li><strong>Unlinkability</strong>:
Block proposers cannot be linked to their proposals through network analysis</li>
<li><strong>Stake privacy</strong>:
Inferring relative stake takes more than 10 years for adversaries controlling 10% stake (targeting 0.1% stake node)</li>
</ol>
<p>The Blend Protocol is one of the Nomos Bedrock Services,
providing censorship resistance and network-level privacy for block producers.
It must be used alongside mempool protections (like NomosDA) to achieve truly privacy-preserving system.</p>
<h2 id="semantics"><a class="header" href="#semantics">Semantics</a></h2>
<p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in RFC 2119.</p>
<h3 id="definitions"><a class="header" href="#definitions">Definitions</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Term</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Data message</strong></td><td>A message generated by a consensus leader containing a block proposal. Indistinguishable from other messages until fully processed.</td></tr>
<tr><td><strong>Cover message</strong></td><td>A message with meaningless content that creates noise for data messages to hide in. Indistinguishable from data messages.</td></tr>
<tr><td><strong>Core node</strong></td><td>A Nomos node that declared willingness to participate in Blend Network through <a href="https://www.notion.so/Service-Declaration-Protocol">SDP</a>. Responsible for message generation, relaying, processing, and broadcasting.</td></tr>
<tr><td><strong>Edge node</strong></td><td>A Nomos node that is not a core node. Connects to core nodes to send messages.</td></tr>
<tr><td><strong>Block proposer node</strong></td><td>A core or edge node generating a new data message.</td></tr>
<tr><td><strong>Blend node</strong></td><td>A core node that processes a data or cover message.</td></tr>
<tr><td><strong>Blending</strong></td><td>Cryptographically transforming and randomly delaying messages to shuffle temporal order.</td></tr>
<tr><td><strong>Broadcasting</strong></td><td>Sending a data message payload (block proposal) to all Nomos nodes.</td></tr>
<tr><td><strong>Disseminating</strong></td><td>Relaying messages by core nodes through the network.</td></tr>
<tr><td><strong>Epoch</strong></td><td>648,000 slots (each 1 second), with average 21,600 blocks per epoch.</td></tr>
<tr><td><strong>Session</strong></td><td>Time period with same set of core nodes executing the protocol. Length follows epoch length (21,600 blocks average).</td></tr>
<tr><td><strong>Round</strong></td><td>Primitive time measure (1 second) during which a node can emit a new message.</td></tr>
<tr><td><strong>Interval</strong></td><td>30 rounds, approximating time between two consecutive block production events.</td></tr>
<tr><td><strong>Blending token</strong></td><td>Information extracted from processed messages, used as proof of processing for rewards.</td></tr>
</tbody></table>
</div>
<h3 id="node-types"><a class="header" href="#node-types">Node Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Honest node</strong></td><td>Follows the protocol fully.</td></tr>
<tr><td><strong>Lazy node</strong></td><td>Does not follow protocol due to lack of incentives; only participates when directly beneficial.</td></tr>
<tr><td><strong>Spammy node</strong></td><td>Emits more messages than protocol expects.</td></tr>
<tr><td><strong>Unhealthy node</strong></td><td>Emits fewer messages than expected (may be under attack).</td></tr>
<tr><td><strong>Malicious node</strong></td><td>Does not follow protocol regardless of incentives.</td></tr>
<tr><td><strong>Unresponsive node</strong></td><td>Does not follow protocol due to technical reasons.</td></tr>
</tbody></table>
</div>
<h3 id="adversary-types"><a class="header" href="#adversary-types">Adversary Types</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Type</th><th>Description</th></tr></thead><tbody>
<tr><td><strong>Passive adversary</strong></td><td>Can only observe, cannot modify node behavior.</td></tr>
<tr><td><strong>Active adversary</strong></td><td>Can modify node behavior and observe network.</td></tr>
<tr><td><strong>Local observer</strong></td><td>Passive adversary with limited network view and ability to observe internals of limited nodes.</td></tr>
</tbody></table>
</div>
<h2 id="document-structure"><a class="header" href="#document-structure">Document Structure</a></h2>
<p>This specification is organized into two distinct parts to serve different audiences and use cases:</p>
<p><strong>Part I: Protocol Specification</strong> contains the normative requirements necessary for implementing an interoperable Blend Protocol node.
This section defines the cryptographic primitives,
message formats,
network protocols,
and behavioral requirements that all implementations MUST follow to ensure compatibility and maintain the protocol's privacy guarantees.
Protocol designers,
auditors,
and those seeking to understand the core mechanisms should focus on this part.</p>
<p><strong>Part II: Implementation Details</strong> provides non-normative guidance for implementers.
This section offers practical recommendations,
optimization strategies,
and detailed examples that help developers build efficient and robust implementations.
While these details are not required for interoperability,
they represent best practices learned from reference implementations and can significantly improve performance and reliability.</p>
<p>This separation provides several benefits:</p>
<ol>
<li><strong>Clarity of Requirements</strong>:
Implementers can clearly distinguish between mandatory requirements for interoperability (Part I) and optional optimizations (Part II)</li>
<li><strong>Protocol Evolution</strong>:
The core protocol specification (Part I) can remain stable while implementation guidance (Part II) evolves with new techniques and optimizations</li>
<li><strong>Multiple Implementations</strong>:
Different implementations can make different trade-offs in Part II while maintaining full compatibility through adherence to Part I</li>
<li><strong>Audit Focus</strong>:
Security auditors can concentrate on the normative requirements in Part I that are critical for the protocol's privacy guarantees</li>
<li><strong>Accessibility</strong>:
Protocol researchers can understand the essential mechanisms without being overwhelmed by implementation details,
while developers get the practical guidance they need</li>
</ol>
<h2 id="part-i-protocol-specification"><a class="header" href="#part-i-protocol-specification">Part I: Protocol Specification</a></h2>
<hr />
<h3 id="protocol-overview"><a class="header" href="#protocol-overview">Protocol Overview</a></h3>
<p>The Blend Protocol works as follows:</p>
<ol>
<li>Core nodes form a network by establishing encrypted connections with other
core nodes at random</li>
<li>A block proposer node selects several core nodes and creates a data message
containing a block proposal that can only be processed by selected nodes in
specified order</li>
<li>The block proposer sends the data message to its neighbors (or connects to
random core nodes if edge node)</li>
<li>Core nodes disseminate (relay) the message to the rest of the network</li>
<li>Core nodes generate new cover messages every round, blended with other
messages</li>
<li>When a data message reaches a designated blend node:
<ul>
<li>Message is cryptographically transformed (incoming/outgoing messages
unlinkable by content)</li>
<li>Message is randomly delayed (unlinkable by timing observation)</li>
</ul>
</li>
<li>The blend node disseminates the processed message so next blend node can
process it</li>
<li>When message reaches the last blend node:
<ul>
<li>Node processes (decrypts and delays) the message</li>
<li>Extracts the block proposal payload</li>
<li>Broadcasts block proposal to Nomos Network</li>
</ul>
</li>
</ol>
<p><strong>Note</strong>:
Current protocol version is optimized for privacy of core nodes.
Edge nodes gain lower privacy level,
which is acceptable as they are assumed mobile without static long-term network identifiers and have lower stake.</p>
<h3 id="network-protocol"><a class="header" href="#network-protocol">Network Protocol</a></h3>
<h4 id="network-formation"><a class="header" href="#network-formation">Network Formation</a></h4>
<p>Core nodes form a peer-to-peer network at the beginning of each session:</p>
<ol>
<li>All core nodes retrieve the set of participating core nodes from <a href="https://www.notion.so/Service-Declaration-Protocol">SDP</a>
protocol</li>
<li>Each core node establishes encrypted connections with randomly selected
core nodes</li>
<li>Network is considered formed when nodes reach minimum connectivity
requirements</li>
</ol>
<p>Edge nodes connect to core nodes on-demand when they need to send messages.</p>
<h4 id="minimal-network-size"><a class="header" href="#minimal-network-size">Minimal Network Size</a></h4>
<p>The protocol requires a minimum number of core nodes to operate safely.
If this minimum is not met,
nodes MUST NOT use the Blend protocol and MUST broadcast data messages directly.</p>
<h4 id="network-maintenance"><a class="header" href="#network-maintenance">Network Maintenance</a></h4>
<p>Nodes monitor connection quality and adjust their connections based on:</p>
<ul>
<li>Message frequency and correctness</li>
<li>Network health indicators</li>
<li>Protocol compliance of peers</li>
</ul>
<p>Nodes may close connections with misbehaving peers and establish new connections to maintain network quality.</p>
<h4 id="session-transitions"><a class="header" href="#session-transitions">Session Transitions</a></h4>
<p>When a new session or epoch begins,
the network implements a transition period to allow messages generated with old credentials to safely complete their journey through the network.</p>
<h3 id="quota-protocol"><a class="header" href="#quota-protocol">Quota Protocol</a></h3>
<p>The protocol limits the number of messages that can be generated during a session through a quota system.
Two types of quota exist:</p>
<ol>
<li><strong>Core Quota</strong>:
Limits cover message generation and blending operations for core nodes during a session</li>
<li><strong>Leadership Quota</strong>:
Limits blending operations a block proposer can perform per proof of leadership</li>
</ol>
<p>Nodes generate session-specific key pools,
where each key is associated with a proof of quota.
This ensures messages are properly rate-limited and nodes cannot exceed their allowed message generation capacity.</p>
<h3 id="message-protocol"><a class="header" href="#message-protocol">Message Protocol</a></h3>
<h4 id="message-structure"><a class="header" href="#message-structure">Message Structure</a></h4>
<p>Messages consist of three components:</p>
<ol>
<li><strong>Public Header (H)</strong>:
Contains public key,
proof of quota,
and signature</li>
<li><strong>Encrypted Private Header (h)</strong>:
Contains blending headers for each hop,
with proofs of selection</li>
<li><strong>Payload (P)</strong>:
The actual content (block proposal or cover message data)</li>
</ol>
<h4 id="message-lifecycle"><a class="header" href="#message-lifecycle">Message Lifecycle</a></h4>
<p>Messages follow a defined lifecycle through the network:</p>
<ol>
<li><strong>Generation</strong>:
Triggered by consensus lottery (data) or schedule (cover)</li>
<li><strong>Relaying</strong>:
Nodes validate and forward messages to neighbors</li>
<li><strong>Processing</strong>:
Designated nodes decrypt and extract next-hop information</li>
<li><strong>Delaying</strong>:
Random delays hide timing correlations</li>
<li><strong>Releasing</strong>:
Messages released according to delay schedule</li>
<li><strong>Broadcasting</strong>:
Final nodes extract and broadcast block proposals</li>
</ol>
<h3 id="proof-mechanisms"><a class="header" href="#proof-mechanisms">Proof Mechanisms</a></h3>
<h4 id="proof-of-quota-poq"><a class="header" href="#proof-of-quota-poq">Proof of Quota (PoQ)</a></h4>
<p>Guarantees that honestly generated messages use valid quota allocation.
Two types exist:</p>
<ul>
<li><strong>Core Quota Proof</strong>:
Validated message is within core node's session quota</li>
<li><strong>Leadership Quota Proof</strong>:
Validated message is within leader's quota per won slot</li>
</ul>
<p>Combined proof uses logical OR of both proof types.</p>
<h4 id="proof-of-selection-posel"><a class="header" href="#proof-of-selection-posel">Proof of Selection (PoSel)</a></h4>
<p>Makes node selection for message processing random and verifiable.
Prevents:</p>
<ul>
<li>Targeting specific nodes</li>
<li>Selfish behavior (sending all messages to self)</li>
<li>Predictable routing patterns</li>
</ul>
<h3 id="rewarding-protocol"><a class="header" href="#rewarding-protocol">Rewarding Protocol</a></h3>
<p>Nodes are rewarded for participating in the protocol:</p>
<ol>
<li><strong>Message Processing</strong>: Nodes collect blending tokens as proof of work</li>
<li><strong>Activity Proof</strong>: Probabilistic attestation using <a href="https://en.wikipedia.org/wiki/Hamming_distance">Hamming distance</a></li>
<li><strong>Two-Tier Rewards</strong>: Base reward for all active nodes, premium reward for
nodes with minimal <a href="https://en.wikipedia.org/wiki/Hamming_distance">Hamming distance</a></li>
</ol>
<h3 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h3>
<h4 id="dos-protection"><a class="header" href="#dos-protection">DoS Protection</a></h4>
<p>Multiple mechanisms prevent denial-of-service attacks:</p>
<ul>
<li>Quota system limits message generation</li>
<li>Connection monitoring detects spammy/malicious nodes</li>
<li>Minimal network size requirement</li>
<li>Message uniqueness verification</li>
</ul>
<h4 id="privacy-properties"><a class="header" href="#privacy-properties">Privacy Properties</a></h4>
<p>The protocol provides probabilistic unlinkability with quantifiable privacy guarantees.
Time to link sender to proposal and time to infer stake increase significantly with each additional hop in the blending path.</p>
<h4 id="attack-resistance"><a class="header" href="#attack-resistance">Attack Resistance</a></h4>
<p>Protection against various attack vectors:</p>
<ul>
<li><strong>Grinding attacks</strong>:
Prevented by unpredictable session randomness</li>
<li><strong>Tagging attacks</strong>:
Addressed by mempool protections (NomosDA)</li>
<li><strong>Timing attacks</strong>:
Mitigated by random delays</li>
<li><strong>Content inspection</strong>:
Prevented by layered encryption</li>
<li><strong>Replay attacks</strong>:
Prevented by TLS and key uniqueness verification</li>
</ul>
<h3 id="rationale"><a class="header" href="#rationale">Rationale</a></h3>
<h4 id="design-decisions"><a class="header" href="#design-decisions">Design Decisions</a></h4>
<p><strong>Blending vs Mixing</strong>:
Protocol uses blending (spatial anonymity through multiple nodes) rather than mixing (temporal anonymity through single node) for higher decentralization and censorship resistance.</p>
<p><strong>Two-tier reward system</strong>:
Base reward ensures fairness;
premium reward continues motivating nodes through lottery mechanism.</p>
<p><strong>Edge node privacy trade-off</strong>:
Lower privacy acceptable as edge nodes are assumed mobile,
without static identifiers,
with lower stake.</p>
<p><strong>Cover traffic motivation</strong>:
Nodes must generate cover messages for own privacy;
protocol enforces statistical indistinguishability.</p>
<p><strong>Statistical bias</strong>:
Modulo operation for node selection introduces negligible bias (&lt; 2^{-128}) for expected network sizes.</p>
<hr />
<h2 id="part-ii-implementation-details"><a class="header" href="#part-ii-implementation-details">Part II: Implementation Details</a></h2>
<hr />
<h3 id="network-implementation"><a class="header" href="#network-implementation">Network Implementation</a></h3>
<h4 id="core-network-bootstrapping"><a class="header" href="#core-network-bootstrapping">Core Network Bootstrapping</a></h4>
<p>At the beginning of a session:</p>
<ol>
<li>All core nodes retrieve fresh set of core nodes' connectivity information
from <a href="https://www.notion.so/Service-Declaration-Protocol">SDP</a> protocol</li>
<li>Each core node selects at random a set of other core nodes and connects
through fully encrypted connections</li>
<li>After all core nodes connect, a new network is formed</li>
</ol>
<h4 id="detailed-bootstrapping-procedure"><a class="header" href="#detailed-bootstrapping-procedure">Detailed Bootstrapping Procedure</a></h4>
<ol>
<li>Core node retrieves set of core nodes' information from SDP protocol at
session start</li>
<li>If number of core nodes is below minimum (32), stop and use regular
broadcasting</li>
<li>Start opening new connections:
<ul>
<li>Select at random (without replacement) a node from set of core nodes</li>
<li>Establish secure TLS 1.3 connection using ephemeral Ed25519 keys</li>
<li>Identify neighbor using Neighbor Distinction Process (NDP)</li>
<li>Stop connecting after reaching maximum retries (3 by default)</li>
</ul>
</li>
<li>Repeat until connected to minimal core peering degree (4 by default, both
incoming and outgoing count)</li>
<li>Start accepting incoming connections and maintaining all connections:
<ul>
<li>Can maintain up to maximum connections with core nodes (8 by default)</li>
<li>Can receive up to maximum connections with edge nodes (300 by default)</li>
</ul>
</li>
<li>If two nodes open connections to each other:
<ul>
<li>Node with lower public key value (provider_id from SDP, compared via
Base58 encoding) closes outgoing connection</li>
<li>Node with higher public key value closes incoming connection</li>
</ul>
</li>
</ol>
<h4 id="connection-details"><a class="header" href="#connection-details">Connection Details</a></h4>
<ul>
<li><strong>Protocol</strong>: libp2p with TLS 1.3 (not older)</li>
<li><strong>Cryptographic scheme</strong>: Ed25519 with ephemeral keys</li>
<li><strong>libp2p protocol name</strong>:
<ul>
<li>Mainnet: <code>/nomos/blend/1.0.0</code></li>
<li>Testnet: <code>/nomos-testnet/blend/1.0.0</code></li>
</ul>
</li>
</ul>
<h4 id="connectivity-maintenance-implementation"><a class="header" href="#connectivity-maintenance-implementation">Connectivity Maintenance Implementation</a></h4>
<p>Core nodes monitor connection quality by verifying message correctness and
frequency:</p>
<ol>
<li>Count messages after successful connection-level decryption during
observation window (30 rounds)</li>
<li>If frequency exceeds maximum: mark neighbor as spammy, close connection,
establish new one</li>
<li>If frequency below minimum: mark connection as unhealthy, establish
additional connection</li>
<li>Unhealthy connections are monitored continuously and may recover</li>
<li>If maximum connections exceeded: log situation, pause new connections until
below maximum</li>
<li>Edge nodes MUST send message immediately after connection then close;
otherwise core node closes connection</li>
<li>Messages with invalid proof of quota or signature from core node: mark as
malicious, close connection</li>
<li>Messages with duplicate identifier: close connection with neighbor (with
grace period for network delay)</li>
</ol>
<h4 id="edge-network-bootstrapping-implementation"><a class="header" href="#edge-network-bootstrapping-implementation">Edge Network Bootstrapping Implementation</a></h4>
<p>Edge nodes connect to core nodes when needing to send messages:</p>
<ol>
<li>Retrieve set of core nodes from SDP at session start</li>
<li>If below minimum size (32), stop and use regular broadcasting</li>
<li>When needing to send message, select random core node</li>
<li>Establish secure TLS connection</li>
<li>Identify and authenticate using NDP</li>
<li>Send message and close connection</li>
<li>Repeat for communication redundancy number (4 by default)</li>
</ol>
<h4 id="transition-period-implementation"><a class="header" href="#transition-period-implementation">Transition Period Implementation</a></h4>
<p>When new session or epoch begins, protocol implements Transition Period (30
rounds) to allow messages generated with old keys to safely exit the network:</p>
<p><strong>New session</strong>:</p>
<ul>
<li>Validate message proofs against both new and past session-related public
input for TP duration</li>
<li>Open new connections for new session</li>
<li>Maintain old connections and process messages for TP duration</li>
</ul>
<p><strong>New epoch</strong>:</p>
<ul>
<li>Validate message proofs against both new and past epoch-related public info
for TP duration</li>
</ul>
<h3 id="quota-implementation"><a class="header" href="#quota-implementation">Quota Implementation</a></h3>
<p>Quota limits the number of messages that can be generated during a session for
network health and fair reward calculation.</p>
<h3 id="core-quota"><a class="header" href="#core-quota">Core Quota</a></h3>
<p>Core quota (Q_C) defines messaging allowance for a core node during single
session:</p>
<pre><code class="language-text">Q_C = ⌈(C · (β_C + R_C · β_C)) / N⌉
</code></pre>
<p>Where:</p>
<ul>
<li>C = S · F_C = expected number of cover messages per session by all core
nodes</li>
<li>β_C = 3 = expected blending operations per cover message</li>
<li>R_C = redundancy parameter for cover messages</li>
<li>N = number of core nodes from SDP</li>
</ul>
<p>Total core quota (all nodes): Q^Total_C = N · Q_C = C · (β_C + R_C · β_C)</p>
<h3 id="leadership-quota"><a class="header" href="#leadership-quota">Leadership Quota</a></h3>
<p>Leadership quota (Q_L) defines blending operations a block proposer can
perform. Single quota used per proof of leadership:</p>
<pre><code class="language-text">Q_L = β_D + β_D · R_D
</code></pre>
<p>Where:</p>
<ul>
<li>β_D = 3 = expected blending operations per data message</li>
<li>R_D = redundancy parameter for data messages</li>
</ul>
<p>Average data messages per session: D_Avg = L_Avg · Q_L, where L_Avg = 21,600
(average leaders per session)</p>
<h4 id="quota-application-details"><a class="header" href="#quota-application-details">Quota Application Details</a></h4>
<p>Nodes create session-specific key pools:</p>
<pre><code class="language-text">K^{n,s}_q = {(K^n_0, k^n_0, π_Q^{K^n_0}), ..., (K^n_{q-1}, k^n_{q-1}, π_Q^{K^n_{q-1}})}
</code></pre>
<p>Where:</p>
<ul>
<li>q = Q_C + Q^n_L = sum of core quota and leadership quota for node n</li>
<li>K^n_i = i-th public key</li>
<li>k^n_i = corresponding private key</li>
<li>π_Q^{K^n_i} = proof of quota (confirms i &lt; h without disclosing node
identity)</li>
</ul>
<h3 id="message-structure-implementation"><a class="header" href="#message-structure-implementation">Message Structure Implementation</a></h3>
<p>A node n constructs message M = (H, h, P):</p>
<h4 id="public-header-h"><a class="header" href="#public-header-h">Public Header (H)</a></h4>
<ul>
<li>K^n_i: public key from set K^n_h</li>
<li>π^{K^n_i}_Q: proof of quota for key (contains key nullifier)</li>
<li>σ_{K^n_i}(P_i): signature of i-th encapsulation, verifiable by K^n_i</li>
</ul>
<h4 id="encrypted-private-header-h"><a class="header" href="#encrypted-private-header-h">Encrypted Private Header (h)</a></h4>
<p>Contains β_max blending headers (b_1, ..., b_{β_max}), each with:</p>
<ul>
<li>K^n_l: public key from set K^n_h</li>
<li>π^{K^n_l}_Q: proof of quota for key</li>
<li>σ_{K^n_l}(P_l): signature of l-th encapsulation</li>
<li>π^{K^n_{l+1}, m_{l+1}}<em>S: proof of selection of node index m</em>{l+1}</li>
<li>Ω: flag indicating last blending header</li>
</ul>
<h4 id="payload-p"><a class="header" href="#payload-p">Payload (P)</a></h4>
<p>Message content (block proposal or random data for cover messages)</p>
<p><strong>Encapsulation Overhead</strong>: Using Groth16 SNARKs, total overhead is ~1123
bytes for 3 hops (~3% increase for typical block proposal of 33,129 bytes).</p>
<h3 id="message-lifecycle-implementation"><a class="header" href="#message-lifecycle-implementation">Message Lifecycle Implementation</a></h3>
<h4 id="generation-details"><a class="header" href="#generation-details">Generation Details</a></h4>
<p>Message generation is triggered by:</p>
<ol>
<li><strong>Data message</strong>: Core/edge node won consensus lottery and has proof of
leadership</li>
<li><strong>Cover message</strong>: Released at random by core node per Cover Message
Schedule</li>
</ol>
<p>Generation process:</p>
<ol>
<li>Generate keys according to <a href="https://nomos-tech.notion.site/Key-Types-and-Generation-Specification-215261aa09df81088b8fd7c3089162e8">Key Types and Generation Specification</a>
<ul>
<li>Each key uses message-type-specific allowance (quota)</li>
<li>Correct usage proven by Proof of Quota</li>
</ul>
</li>
<li>Format payload according to Payload Formatting Specification</li>
<li>Encapsulate payload using Message Encapsulation Mechanism
<ul>
<li>Each key for single encapsulation, processable by single node</li>
<li>Node selection is random and deterministic, provable by Proof of
Selection</li>
</ul>
</li>
<li>Format message according to Message Formatting Specification</li>
<li>Release message according to Releasing logic</li>
</ol>
<h4 id="relaying-details"><a class="header" href="#relaying-details">Relaying Details</a></h4>
<p>When node receives message from neighbor:</p>
<ol>
<li>Check public header:
<ul>
<li>Version MUST equal 0x01</li>
<li>Proof of quota MUST be valid</li>
<li>Signature MUST be valid</li>
<li>Public key MUST be unique</li>
</ul>
</li>
<li>Release message to network (Releasing section)</li>
<li>Concurrently, add message to processing queue (Processing section)</li>
</ol>
<p><strong>Duplicate Detection</strong>: Node MUST cache public key for every relayed message
for duration of session plus safety buffer and transition period (~65 MB).</p>
<h4 id="processing-details"><a class="header" href="#processing-details">Processing Details</a></h4>
<p>When message M is received with correct public header:</p>
<ol>
<li>Decapsulate message per Message Encapsulation Mechanism</li>
<li>If decapsulation succeeds:
<ul>
<li>Validate proof of selection (points to node index in SDP list)</li>
<li>Store blending token: τ = (π^{K^n_l}_Q, π^{K^n_l,l}_S)</li>
<li>If last flag set (Ω == 1):
<ul>
<li>If payload is block proposal: verify structure and broadcast</li>
<li>If payload is cover message: discard</li>
</ul>
</li>
<li>Else:
<ul>
<li>Validate decapsulated public header (key uniqueness, signature, proof
of quota)</li>
<li>Format message per Message Formatting Specification</li>
<li>Attempt subsequent decapsulation recursively</li>
<li>If decapsulation fails: randomly delay and release to neighbors</li>
</ul>
</li>
</ul>
</li>
<li>If decapsulation fails: return failure message</li>
</ol>
<h4 id="delaying-details"><a class="header" href="#delaying-details">Delaying Details</a></h4>
<p>Purpose: Hide timing correlations between incoming/outgoing messages.</p>
<p>Maximum delay between release attempts: Δ_max = 3 rounds</p>
<p>Delaying logic:</p>
<ol>
<li>Select random delay: δ ∈ (1, Δ_max)</li>
<li>Start counting rounds from r_s</li>
<li>Every round check if r_c == r_s + δ:
<ul>
<li>Release messages from queue (Releasing logic)</li>
<li>Select new random delay</li>
<li>Restart round counting</li>
</ul>
</li>
</ol>
<p>Release round selection works independently of queue state.</p>
<h4 id="releasing-details"><a class="header" href="#releasing-details">Releasing Details</a></h4>
<p>Release process:</p>
<ul>
<li><strong>Received messages</strong>: Immediately released to all neighbors (except sender)
after header validation</li>
<li><strong>Processed messages</strong>: Queued and released at next release round (per
Delaying logic)</li>
<li><strong>Generated messages</strong>: Released at beginning of next round after generation</li>
<li><strong>Statistical indistinguishability</strong>: When data message generated, one random
unreleased cover message MUST be removed from schedule</li>
<li><strong>Multiple messages</strong>: If multiple messages scheduled for same round,
randomly shuffle before release</li>
</ul>
<p>Expected messages per release round for single node:</p>
<pre><code class="language-text">μ = ⌈(Δ_max · β_C · α) / N⌉
</code></pre>
<p>Where:</p>
<ul>
<li>Δ_max = 3 (maximal delay)</li>
<li>β_C = 3 (blending operations per cover message)</li>
<li>α ≈ 1.03 (normalization constant for data messages)</li>
<li>N = number of core nodes</li>
</ul>
<p>Results:</p>
<ul>
<li>N=16: μ=1 message per round</li>
<li>N=8: μ=2 messages per round</li>
<li>N=4: μ=3 messages per round</li>
</ul>
<h3 id="broadcasting-implementation"><a class="header" href="#broadcasting-implementation">Broadcasting Implementation</a></h3>
<p>When payload added to broadcasting queue:</p>
<ol>
<li>Verify payload contains valid block proposal structure (proposal not
validated yet)</li>
<li>Extract block proposal</li>
<li>Broadcast to Nomos broadcasting channel after random delay</li>
</ol>
<h2 id="cover-message-schedule-implementation"><a class="header" href="#cover-message-schedule-implementation">Cover Message Schedule Implementation</a></h2>
<p>Core nodes generate cover messages in fully random manner to maintain privacy.
Messages evenly distributed across session duration.</p>
<h3 id="safety-buffer-implementation"><a class="header" href="#safety-buffer-implementation">Safety Buffer Implementation</a></h3>
<p>Problem: Session length in rounds is non-deterministic due to random block
production. Safety buffer (100 intervals) reserves cover messages for when
session lasts longer than expected.</p>
<h3 id="cover-message-generation-algorithm"><a class="header" href="#cover-message-generation-algorithm">Cover Message Generation Algorithm</a></h3>
<p>Given:</p>
<ul>
<li>Core quota Q_C</li>
<li>Expected blending operations β_C = 3</li>
<li>Last interval I_end = 21,600</li>
<li>Last interval of safety buffer I_max &gt; I_end</li>
</ul>
<p>For every session:</p>
<ol>
<li>Calculate maximum cover messages: c = ⌈Q_C / β_C⌉</li>
<li>For i ∈ {1, ..., c}:
<ul>
<li>Select random interval I ∈ {1, ..., I_max}</li>
<li>Select random round r ∈ {1, ..., |I|}</li>
<li>If (I, r) already selected, repeat; else add to winning slots W</li>
</ul>
</li>
<li>During each interval I and round r: if (I, r) ∈ W, generate cover message</li>
</ol>
<p><strong>Important</strong>: Number of generated cover messages MUST be reduced by number of
data messages node generates during session (for statistical
indistinguishability).</p>
<h2 id="proof-mechanisms-implementation"><a class="header" href="#proof-mechanisms-implementation">Proof Mechanisms Implementation</a></h2>
<h3 id="proof-of-quota-implementation-poq"><a class="header" href="#proof-of-quota-implementation-poq">Proof of Quota Implementation (PoQ)</a></h3>
<p>Guarantees honestly generated messages are relayed and disseminated. Two parts:</p>
<p><strong>Core Quota Proof</strong> (π^{K^n_a}_{Q_C}) is true when:</p>
<ul>
<li>n ∈ N = SDP(s): node is in registered set (identity hidden)</li>
<li>K^n_a ∈ K^{n,s}_h: key generated by node for session</li>
<li>a &lt; Q_C: index limits proof nullifiers per session</li>
</ul>
<p>Public input: s, K^n_a, Q_C
Private input: n, a
Public output: ν_s (key nullifier uniquely identifying PoQ)</p>
<p><strong>Leadership Quota Proof</strong> (π^{K^n_b}_{Q_L}) is true when:</p>
<ul>
<li>∃ π^{n,e}_L: valid proof of leadership for node n in epoch e</li>
<li>K^n_b ∈ K^{n,s}_h: key generated by node for session</li>
<li>b &lt; Q^n_L: index limits proof nullifiers per won slot</li>
</ul>
<p>Public input: e, s, K^n_b, Q^n_L
Private input: π^{n,e}_L, n, b
Public output: ν_s (key nullifier)</p>
<p><strong>Combined Proof</strong>: π^{K^n_i}<em>Q = π^{K^n_i}</em>{Q_C} ∨ π^{K^n_i}_{Q_L} (logical
OR)</p>
<h3 id="proof-of-selection-implementation-posel"><a class="header" href="#proof-of-selection-implementation-posel">Proof of Selection Implementation (PoSel)</a></h3>
<p>Makes node selection for message processing random and verifiable. Prevents
targeting specific nodes and selfish behavior.</p>
<p>PoSel (π^{K^n_i, m_i}_S) is true when:</p>
<ul>
<li>m_i = CSPRBG(H_N(ρ))_8 mod N, where:
<ul>
<li>ρ = secret selection randomness (little-endian)</li>
<li>m_i = recipient node index (little-endian)</li>
<li>CSPRBG()_8 = cryptographically secure pseudo-random bytes generator (8
bytes, little-endian)</li>
<li>H_N() = domain separated blake2b hash</li>
<li>N = number of core nodes</li>
</ul>
</li>
<li>v == v', where:
<ul>
<li>v = key nullifier of π^{K^n_i}_Q</li>
<li>v' = H_Ψ(b"KEY_NULLIFIER\V1", ρ)</li>
<li>H_Ψ() = Poseidon2 hash function</li>
</ul>
</li>
</ul>
<p>PoSel MUST be used alongside PoQ as they are tightly coupled.</p>
<h2 id="rewarding-implementation"><a class="header" href="#rewarding-implementation">Rewarding Implementation</a></h2>
<h3 id="rewarding-motivation-details"><a class="header" href="#rewarding-motivation-details">Rewarding Motivation Details</a></h3>
<p>Nodes must be rewarded for protocol actions:</p>
<ol>
<li><strong>Message generation</strong>: Especially for cover messages (data messages
rewarded through consensus)</li>
<li><strong>Message relaying</strong>: Motivated by connection quality monitoring (fear of
losing reward)</li>
<li><strong>Message processing</strong>: Motivated by collecting blending tokens
(activity-based reward)</li>
<li><strong>Message broadcasting</strong>: Motivated by increasing service income pool</li>
</ol>
<h3 id="blending-tokens-implementation"><a class="header" href="#blending-tokens-implementation">Blending Tokens Implementation</a></h3>
<p>When node processes message, it stores blending token:</p>
<pre><code class="language-text">τ = (π^{K^n_l}_Q, π^{K^n_l,l}_S)
</code></pre>
<p>Tokens stored with context (session number) in set Τ^{l,s}.</p>
<h3 id="session-randomness-implementation"><a class="header" href="#session-randomness-implementation">Session Randomness Implementation</a></h3>
<p>Rewarding requires common unbiased randomness provided by consensus:</p>
<pre><code class="language-text">R_s = H('BLEND_SESSION_RANDOMNESS\V1' || R_e(s) || s)_512
</code></pre>
<p>Where:</p>
<ul>
<li>H()_512 = blake2b hash (512 bits output)</li>
<li>R_e(s) = epoch nonce from consensus for epoch corresponding to session s</li>
<li>s = session number</li>
</ul>
<h3 id="activity-proof-implementation"><a class="header" href="#activity-proof-implementation">Activity Proof Implementation</a></h3>
<p>Node activity proof (π^{l,τ,s}_A) attests in probabilistic manner that node l
was active during session s by presenting blending token τ.</p>
<p>Activity proof is true when:</p>
<ul>
<li>Node l has blending token τ ∈ Τ^{l,s} collected during session s where:
<ul>
<li>Proof of Quota π^{K^n_l}_Q ∈ τ is true for session s</li>
<li>Proof of Selection π^{K^n_l,l}_S ∈ τ is true for session s</li>
</ul>
</li>
<li>Hamming distance between token and next session randomness is below activity
threshold:</li>
</ul>
<pre><code class="language-text">Δ_H(H(τ)_ε, H(R_{s+1})_ε) &lt; A_ε
</code></pre>
<p>Where:</p>
<ul>
<li>H() = blake2b hash</li>
<li>ε = ⌈log_2(Q^Total_C + 1) / 8⌉ · 8 (bits, rounded to full bytes)</li>
</ul>
<p><strong>Activity Threshold</strong>:</p>
<pre><code class="language-text">A_ε = χ - ν - θ
</code></pre>
<p>Where:</p>
<ul>
<li>ν = ⌈log_2(N + 1)⌉ (bits needed for number of nodes)</li>
<li>χ = ⌈log_2(Q^Total_C + 1)⌉ (bits needed for all blending tokens)</li>
<li>θ = 1 (sensitivity parameter)</li>
</ul>
<h3 id="active-message-implementation"><a class="header" href="#active-message-implementation">Active Message Implementation</a></h3>
<p>Node l constructs active message M_A = {l, τ, s, π^{l,τ,s}_A} for every
session following Active Message format.</p>
<p>Active message metadata field MUST start with one byte version field (fixed to
0x01), followed by Activity Proof.</p>
<p>Node l selects activity proof minimizing Hamming distance to new randomness:</p>
<pre><code class="language-text">π^{l,τ,s}_A = min_{Δ_H}(true(π^{i,τ,s}_A))
</code></pre>
<p>Active message for session s MUST only be sent during session s+1; otherwise
rejected.</p>
<p>Ledger MUST only accept single active message per-node per-session. Duplicates
rejected.</p>
<h3 id="reward-calculation-details"><a class="header" href="#reward-calculation-details">Reward Calculation Details</a></h3>
<p>Rewards for session s calculated as:</p>
<ol>
<li><strong>No calculation</strong> if number of nodes from SDP below Minimal Network Size
(32)</li>
<li><strong>Count base proofs</strong>: B = number of true activity proofs</li>
<li><strong>Count premium proofs</strong>: P = number of true activity proofs with minimal
Hamming distance</li>
<li><strong>Calculate base reward</strong>: R = I / (B + P), where I = service income for
session s</li>
<li><strong>Calculate node reward</strong>:</li>
</ol>
<pre><code class="language-text">R(n) = R · [true(π^{i,τ,s}_A) + min_{Δ_H}(true(π^{i,τ,s}_A))]
</code></pre>
<p>Base reward (R) paid to all nodes with true activity proof; reward doubled for
nodes with minimal Hamming distance proof.</p>
<h3 id="rewarding-distribution-logic-details"><a class="header" href="#rewarding-distribution-logic-details">Rewarding Distribution Logic Details</a></h3>
<ol>
<li>Node sends Active Message with activity proof in metadata field
<ul>
<li>Must point to single declaration (declaration_id) and single provider
identity (provider_id)</li>
<li>Any reuse of provider_id makes Active Message invalid</li>
</ul>
</li>
<li>Active Message sent after end of session s (during s+1), after transition
period
<ul>
<li>Delay allows including tokens from transition period</li>
</ul>
</li>
<li>When session s+2 begins, Mantle distributes rewards per Service Reward
Distribution Protocol
<ul>
<li>Delay required to calculate reward partition</li>
</ul>
</li>
<li>No Active Message on time = no reward</li>
</ol>
<h2 id="security-considerations-implementation"><a class="header" href="#security-considerations-implementation">Security Considerations Implementation</a></h2>
<h3 id="dos-protection-details"><a class="header" href="#dos-protection-details">DoS Protection Details</a></h3>
<p>The protocol includes multiple DoS mitigation mechanisms:</p>
<ul>
<li>Quota system limits message generation</li>
<li>Connectivity maintenance monitors and drops spammy/malicious nodes</li>
<li>Minimal network size requirement (32 nodes)</li>
<li>Connection limits prevent resource exhaustion</li>
<li>Message uniqueness verification prevents replay attacks</li>
</ul>
<h3 id="privacy-properties-details"><a class="header" href="#privacy-properties-details">Privacy Properties Details</a></h3>
<p><strong>Unlinkability</strong>: For adversary controlling 10% stake targeting 0.1% stake
node with 3-hop blending:</p>
<ul>
<li>Time to Link (TTL): &gt; 9 epochs</li>
<li>Time to Infer (TTI): &gt; 10 years (487 epochs)</li>
</ul>
<p><strong>Trade-offs</strong>:</p>
<ul>
<li>Each additional hop increases TTL/TTI by ~10x</li>
<li>Latency penalty: ~1.5s per hop</li>
<li>Optimal configuration: 3-hop blending (4.5s average latency increase)</li>
</ul>
<h3 id="attack-resistance-details"><a class="header" href="#attack-resistance-details">Attack Resistance Details</a></h3>
<ul>
<li><strong>Grinding attacks</strong>: Prevented by unpredictable session randomness</li>
<li><strong>Tagging attacks</strong>: Addressed by NomosDA (separate mempool protection)</li>
<li><strong>Timing attacks</strong>: Mitigated by random delays (Δ_max = 3 rounds)</li>
<li><strong>Content inspection</strong>: Prevented by layered encryption</li>
<li><strong>Replay attacks</strong>: Prevented by TLS and public key uniqueness verification</li>
</ul>
<h2 id="rationale-implementation"><a class="header" href="#rationale-implementation">Rationale Implementation</a></h2>
<h3 id="design-decisions-details"><a class="header" href="#design-decisions-details">Design Decisions Details</a></h3>
<p><strong>Blending vs Mixing</strong>: Anonymity in blending comes from processing same
message by multiple nodes (spatial anonymity), while mixing processes multiple
messages by same node (temporal anonymity). Blending chosen for higher
decentralization and censorship resistance.</p>
<p><strong>Two-tier reward system</strong>: Base reward ensures fairness (all active nodes
receive it); premium reward continues motivating lazy nodes through lottery
mechanism.</p>
<p><strong>Edge node privacy trade-off</strong>: Lower privacy acceptable as edge nodes
assumed mobile, without static identifiers, with lower stake, and sporadic
connections.</p>
<p><strong>Cover traffic motivation</strong>: Nodes must generate cover messages for own
privacy protection; protocol enforces indistinguishability by requiring cover
message removal when data message generated.</p>
<p><strong>Statistical bias</strong>: Modulo operation for node selection introduces negligible
bias (&lt; 2^{-128} for N &lt; 2^{128}), acceptable for expected network sizes (&lt;
10 million nodes).</p>
<h2 id="parameters-summary"><a class="header" href="#parameters-summary">Parameters Summary</a></h2>
<h3 id="global-parameters"><a class="header" href="#global-parameters">Global Parameters</a></h3>
<ul>
<li>Session length (S): 648,000 rounds (average 21,600 blocks)</li>
<li>Interval length: 30 rounds</li>
<li>Maximum delay (Δ_max): 3 rounds</li>
<li>Maximum blending operations (β_max): 3</li>
<li>Expected blending operations (β_C, β_D): 3</li>
<li>Observation window (W): 30 rounds</li>
<li>Safety buffer: 100 intervals</li>
<li>Transition period: 30 rounds</li>
<li>Minimal network size: 32 nodes</li>
</ul>
<h3 id="core-node-parameters"><a class="header" href="#core-node-parameters">Core Node Parameters</a></h3>
<ul>
<li>Minimal core peering degree (Φ_{CC}^{Min}): 4</li>
<li>Maximum core peering degree (Φ_{CC}^{Max}): 8</li>
<li>Maximum edge connections (Φ_{CE}^{Max}): 300</li>
<li>Maximum connection retries (Ω_C): 3</li>
</ul>
<h3 id="edge-node-parameters"><a class="header" href="#edge-node-parameters">Edge Node Parameters</a></h3>
<ul>
<li>Connection redundancy (Φ_{EC}): 4</li>
<li>Maximum connection retries (Ω_E): 3</li>
</ul>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<h3 id="normative"><a class="header" href="#normative">Normative</a></h3>
<ul>
<li><a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a> - Key words for use in LIPs
to Indicate Requirement Levels</li>
<li><a href="https://www.notion.so/Service-Declaration-Protocol">Service Declaration Protocol</a>
- Nomos SDP specification</li>
<li><a href="https://www.notion.so/Nomos-Bedrock">Nomos Bedrock</a> - Nomos foundational
layer specification</li>
<li><a href="https://www.notion.so/NomosDA-Network-Specification-1fd261aa09df81188e76cb083791252d">Data Availability Network Specification</a>
- NomosDA specification</li>
<li><a href="https://www.notion.so/Service-Reward-Distribution-Protocol">Service Reward Distribution Protocol</a>
- Reward distribution specification</li>
</ul>
<h3 id="informative"><a class="header" href="#informative">Informative</a></h3>
<ul>
<li><a href="https://nomos-tech.notion.site/Blend-Protocol-215261aa09df81ae8857d71066a80084">Blend Protocol</a>
- Original Blend Protocol documentation</li>
<li><a href="https://www.notion.so/Nomos-Services">Nomos Services</a> - Overview of Nomos
services architecture</li>
<li><a href="https://www.notion.so/Anonymous-Leaders-Reward-Protocol">Anonymous Leaders Reward Protocol</a>
- Consensus reward mechanism</li>
<li><a href="https://www.notion.so/Cryptarchia-v1-Protocol-Specification">Cryptarchia v1 Protocol Specification</a>
- Consensus protocol details</li>
<li><a href="https://www.notion.so/Block-Construction-Validation-and-Execution-Specification">Block Construction, Validation and Execution Specification</a>
- Block structure details</li>
</ul>
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p>Copyright and related rights waived via
<a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../blockchain/raw/cryptarchia-v1-bootstr-sync.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../blockchain/raw/nomos-cryptarchia-v1-protocol.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../blockchain/raw/cryptarchia-v1-bootstr-sync.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../blockchain/raw/nomos-cryptarchia-v1-protocol.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../../scripts/rfc-index.js"></script>


    </div>
    </body>
</html>
